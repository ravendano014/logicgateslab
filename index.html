<!DOCTYPE html>
<html>
<head>
    <title>Shapes con Conectores en Canvas</title>
    <style>
@import 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet';

:root {
	--dk-gray-100: #F3F4F6;
	--dk-gray-200: #E5E7EB;
	--dk-gray-300: #D1D5DB;
	--dk-gray-400: #9CA3AF;
	--dk-gray-500: #6B7280;
	--dk-gray-600: #4B5563;
	--dk-gray-700: #374151;
	--dk-gray-800: #1F2937;
	--dk-gray-900: #111827;
	--dk-dark-bg: #313348;
	--dk-darker-bg: #2a2b3d;
	--navbar-bg-color: #6f6486;
	--sidebar-bg-color: #252636;
	--sidebar-width: 136px;
}

* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
}

body {
	font-family: 'Inter', sans-serif;
	background-color: var(--dk-darker-bg);
	font-size: .925rem;
}

#wrapper {
	margin-left: var(--sidebar-width);
	transition: all .3s ease-in-out;
}

#wrapper.fullwidth {
	margin-left: 0;
}



/** --------------------------------
 -- Sidebar
-------------------------------- */
.sidebar {
  width: 135px;
  height: 100%;
  color: var(--dk-gray-700);
  background-color: var(--dk-dark-bg);;
  position: absolute;
  top: 0;
  left: 0;
  overflow-y: scroll;
  padding: 10px;
  color: var(--dk-gray-400);
}

.sidebar .close-aside {
	position: absolute;
	top: 7px;
	right: 7px;
	cursor: pointer;
	color: #EEE;
}

.sidebar .sidebar-header {
	border-bottom: 1px solid #2a2b3c
}

.sidebar .sidebar-header h5 a {
	color: var(--dk-gray-300)
}

.sidebar .sidebar-header p {
	color: var(--dk-gray-400);
	font-size: .825rem;
}

.sidebar .search .form-control ~ i {
	color: #2b2f3a;
	right: 40px;
	top: 22px;
}

.sidebar > ul > li {
	padding: .7rem 1.75rem;
}

.sidebar ul > li > a {
	color: var(--dk-gray-400);
	text-decoration: none;
}

/* Start numbers */
.sidebar ul > li > a > .num {
	line-height: 0;
	border-radius: 3px;
	font-size: 14px;
	padding: 0px 5px
}

.sidebar ul > li > i {
	font-size: 18px;
	margin-right: .7rem;
	color: var(--dk-gray-500);
}

.sidebar ul > li.has-dropdown > a:after {
	content: '\eb3a';
	font-family: unicons-line;
	font-size: 1rem;
	line-height: 1.8;
	float: right;
	color: var(--dk-gray-500);
	transition: all .3s ease-in-out;
}

.sidebar ul .opened > a:after {
	transform: rotate(-90deg);
}

/* Start dropdown menu */
.sidebar ul .sidebar-dropdown {
	padding-top: 10px;
	padding-left: 30px;
	display: none;
}
.sidebar ul .sidebar-dropdown.active {
	display: block;
}

.sidebar ul .sidebar-dropdown > li > a {
  font-size: .85rem;
	padding: .5rem 0;
	display: block;
}
/* End dropdown menu */


.show-sidebar {
	transform: translateX(-270px);
}

@media (max-width: 767px) {
	.sidebar ul > li {
		padding-top: 12px;
		padding-bottom: 12px;
	}

	.sidebar .search {
		padding: 10px 0 10px 30px
	}
}

           .shape-item {
                cursor: pointer;
                margin-bottom: 10px;
                padding: 5px;
                border: 1px solid #ccc;
                background-color: #fff;
            }

            .canvas-container {
                margin-left: 160px; /* Espacio para la barra lateral */
              background-color: #fff;
            }

            /* Oculta inicialmente el contenido del grupo */
            .shape-group-content {
                display: none;
            }

            /* Estilo del botón que despliega/oculta el contenido */
            .shape-group-toggle {
                background-color: #ccc;
                border: none;
                padding: 5px 10px;
                cursor: pointer;
            }

            /* Estilo cuando el grupo está abierto */
            .shape-group.open .shape-group-content {
                display: block;
            }

            /* Cambia el aspecto del botón cuando el grupo está abierto */
            .shape-group.open .shape-group-toggle {
                background-color: #aaa;
            }
                    /* Estilo del botón que despliega/oculta el contenido */
            .sidebar-divider {
                background-color: var(--dk-gray-600);
                color: #e5e4e2;
                border: 2;
                text-align: center; /* Centra el texto horizontalmente */
                margin-top: 5px; /* Ajusta el margen superior según tus necesidades */
                font-weight: bold; /* Otras propiedades de estilo, si es necesario */
                margin-bottom: 5px;
            }


.main-color {
	color: #ffc107
}

.navbar {
	background-color: var(--navbar-bg-color) !important;
	border: none !important;
}
.navbar .dropdown-menu {
	right: auto !important;
	left: 0 !important;
}
.navbar .navbar-nav>li>a {
	color: #EEE !important;
	line-height: 55px !important;
	padding: 0 10px !important;
}
.navbar .navbar-brand {color:#FFF !important}
.navbar .navbar-nav>li>a:focus,
.navbar .navbar-nav>li>a:hover {color: #EEE !important}

.navbar .navbar-nav>.open>a,
.navbar .navbar-nav>.open>a:focus,
.navbar .navbar-nav>.open>a:hover {background-color: transparent !important; color: #FFF !important}

.navbar .navbar-brand {line-height: 55px !important; padding: 0 !important}
.navbar .navbar-brand:focus,
.navbar .navbar-brand:hover {color: #FFF !important}
.navbar>.container .navbar-brand, .navbar>.container-fluid .navbar-brand {margin: 0 !important}
@media (max-width: 767px) {
	.navbar>.container-fluid .navbar-brand {
		margin-left: 15px !important;
	}
	.navbar .navbar-nav>li>a {
		padding-left: 0 !important;
	}
	.navbar-nav {
		margin: 0 !important;
	}
	.navbar .navbar-collapse,
	.navbar .navbar-form {
		border: none !important;
	}
}

.navbar .navbar-nav>li>a {
	float: left !important;
}
.navbar .navbar-nav>li>a>span:not(.caret) {
	background-color: #e74c3c !important;
	border-radius: 50% !important;
	height: 25px !important;
	width: 25px !important;
	padding: 2px !important;
	font-size: 11px !important;
	position: relative !important;
	top: -10px !important;
	right: 5px !important
}
.dropdown-menu>li>a {
	padding-top: 5px !important;
	padding-right: 5px !important;
}
.navbar .navbar-nav>li>a>i {
	font-size: 18px !important;
}


.toolbar {
  text-align: center;
}

.toolbar a,
.fore-wrapper,
.back-wrapper {
  border: 1px solid #AAA;
  background: #FFF;
  font-family: 'Candal';
  border-radius: 1px;
  color: black;
  padding: 5px;
  width: 1.5em;
  margin: -2px;
  margin-top: 10px;
  display: inline-block;
  text-decoration: none;
  box-shadow: 0px 1px 0px #CCC;
}

.toolbar a:hover, .fore-wrapper:hover, .back-wrapper:hover {
  background: #f2f2f2;
  border-color: #8c8c8c;
}




a[data-command='redo'],a[data-command='strikeThrough'],a[data-command='justifyFull'],a[data-command='insertOrderedList'],a[data-command='outdent'],a[data-command='p'],a[data-command='superscript']{
  margin-right:5px;
  border-radius:0 3px 3px 0;
}

a[data-command='undo'],.fore-wrapper,a[data-command='justifyLeft'],a[data-command='insertUnorderedList'],a[data-command='indent'],a[data-command='h1'],a[data-command='subscript']{
  border-radius:3px 0 0 3px;
}

a.palette-item {
  height: 1em;
  border-radius: 3px;
  margin: 2px 1px;
  width: 1em;
}

.fore-palette,
.back-palette {
  display: none;
}

.fore-wrapper,
.back-wrapper {
  display: inline-block;
  cursor: pointer;
}

.fore-wrapper:hover .fore-palette,
.back-wrapper:hover .back-palette {
  display: block;
  float: left;
  position: absolute;
  padding: 3px;
  width: 10em;
  background: #FFF;
  border: 1px solid #DDD;
  box-shadow: 0 0 5px #CCC;
  height: 4.4em;
}

.fore-wrapper:hover .fore-palette {
  left: 34%;
  top: 42px;
}

.back-wrapper:hover .back-palette {
  left: 36%;
  top: 42px;
}

.fore-palette a,
.back-palette a {
  background: #FFF;
  margin-bottom: 2px;
}

input[type="range"] {
  width:40px;
}

/* Start media query */

@media (max-width: 767px) {
	#wrapper {
		margin: 0 !important
	}
	.statistics .box {
		margin-bottom: 25px !important;
	}
	.navbar .navbar-nav .open .dropdown-menu>li>a {
		color: #CCC !important
	}
	.navbar .navbar-nav .open .dropdown-menu>li>a:hover {
		color: #FFF !important
	}
	.navbar .navbar-toggle{
		border:none !important;
		color: #EEE !important;
		font-size: 18px !important;
	}
	.navbar .navbar-toggle:focus, .navbar .navbar-toggle:hover {background-color: transparent !important}
}


::-webkit-scrollbar {
	background: transparent;
	width: 5px;
	height: 5px;
}

::-webkit-scrollbar-thumb {
	background-color: #3c3f58;
}

::-webkit-scrollbar-thumb:hover {
	background-color: rgba(0, 0, 0, 0.3);
}

button {
    background-color: transparent;
    background-repeat: no-repeat;
    border: none;
    cursor: pointer;
    overflow: hidden;
    outline: none;
}

button:hover {
    background-color: rgba(204, 186, 186, 0.3);
}

button:hover svg {
    fill: white; 
}

    </style>
</head>
<body>
    <div class="sidebar">
            <div>
                <input type="file" id="loadFile" accept=".json" style="display: none;">
            </div>
            <div id="properties" style="display: none;">
                <div class="sidebar-divider">
                    Properties
                </div>
                <label for="shapeLabel">label:</label>
                <input type="text" id="shapeLabel"><br>
                <label for="shapeX">X:</label>
                <input type="number" id="shapeX"><br>
                <label for="shapeY">Y:</label>
                <input type="number" id="shapeY"><br>
                <select id="colorSelect">
                    <option value="red">Red</option>
                    <option value="green">Green</option>
                    <option value="blue">Blue</option>
                    <option value="yellow">Yellow</option>
                </select>
                <!-- Campos para editar las etiquetas de los inputs y outputs -->
                <h4>Inputs:</h4>
                <div id="inputsContainer"></div>
                <h4>Outputs:</h4>
                <div id="outputsContainer"></div>
                <button id="applyProperties" class="shape-group-toggle">Apply changes</button>
            </div>
        <div class="sidebar-divider">
            Samples
        </div>
        <div class="shape-group">
            <button class="shape-group-toggle" onclick="toggleShapeGroup(this);">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-cloud-arrow-down" viewBox="0 0 16 16" id="IconChangeColor"> <path fill-rule="evenodd" d="M7.646 10.854a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 9.293V5.5a.5.5 0 0 0-1 0v3.793L6.354 8.146a.5.5 0 1 0-.708.708l2 2z" id="mainIconPathAttribute"></path> <path d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z" id="mainIconPathAttribute"></path> </svg> 
            </button>
            <div class="shape-group-content">
                <select id="elementSelector">
                    <option value="">Select Sample</option>
                </select>
            </div>
        </div>
        <div class="sidebar-divider">
           Toolbar
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="Text">
            <?xml version="1.0" standalone="no"?>
            <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" 
            "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"> 
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-file-font" viewBox="0 0 16 16" id="Text"> 
                <path d="M10.943 4H5.057L5 6h.5c.18-1.096.356-1.192 1.694-1.235l.293-.01v6.09c0 .47-.1.582-.898.655v.5H9.41v-.5c-.803-.073-.903-.184-.903-.654V4.755l.298.01c1.338.043 1.514.14 1.694 1.235h.5l-.057-2z" id="mainIconPathAttribute"></path> <path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z" id="mainIconPathAttribute"></path> 
            </svg> 
        </div>

        <div class="shape-item" onclick="buildComponent()">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-cpu" viewBox="0 0 16 16" id="IconChangeColor"> <path d="M5 0a.5.5 0 0 1 .5.5V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2A2.5 2.5 0 0 1 14 4.5h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14a2.5 2.5 0 0 1-2.5 2.5v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14A2.5 2.5 0 0 1 2 11.5H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2A2.5 2.5 0 0 1 4.5 2V.5A.5.5 0 0 1 5 0zm-.5 3A1.5 1.5 0 0 0 3 4.5v7A1.5 1.5 0 0 0 4.5 13h7a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 11.5 3h-7zM5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3zM6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z" id="mainIconPathAttribute"></path> </svg> 
        </div>
        <div class="shape-item">
            <label for="zoomSlider">Zoom:</label>
            <input type="range" id="zoomSlider" min="1" max="100" step="1" value="100" oninput="zoomCanvas()">
            <span id="zoomValue">100%</span>
        </div>
        <div class="shape-item" onclick="generateTruthTable()">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-grid-3x3" viewBox="0 0 16 16" id="IconChangeColor"> <path d="M0 1.5A1.5 1.5 0 0 1 1.5 0h13A1.5 1.5 0 0 1 16 1.5v13a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 0 14.5v-13zM1.5 1a.5.5 0 0 0-.5.5V5h4V1H1.5zM5 6H1v4h4V6zm1 4h4V6H6v4zm-1 1H1v3.5a.5.5 0 0 0 .5.5H5v-4zm1 0v4h4v-4H6zm5 0v4h3.5a.5.5 0 0 0 .5-.5V11h-4zm0-1h4V6h-4v4zm0-5h4V1.5a.5.5 0 0 0-.5-.5H11v4zm-1 0V1H6v4h4z" id="mainIconPathAttribute"></path> </svg> 
        </div>
        <div class="sidebar-divider">
            Input Controls
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="InputL">
            <svg id="InputL" xmlns="http://www.w3.org/2000/svg" width="50" height="50">
                <circle cx="23" cy="25" r="20" stroke="#000" stroke-width="4" fill="white" />
                <line x1="23" y1="0" x2="23" y2="25" stroke="#000" stroke-width="5" />
            </svg>
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="Clock">
            <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-stopwatch" viewBox="0 0 16 16" id="Clock"> 
                <path d="M8.5 5.6a.5.5 0 1 0-1 0v2.9h-3a.5.5 0 0 0 0 1H8a.5.5 0 0 0 .5-.5V5.6z" id="mainIconPathAttribute"></path> 
                <path d="M6.5 1A.5.5 0 0 1 7 .5h2a.5.5 0 0 1 0 1v.57c1.36.196 2.594.78 3.584 1.64a.715.715 0 0 1 .012-.013l.354-.354-.354-.353a.5.5 0 0 1 .707-.708l1.414 1.415a.5.5 0 1 1-.707.707l-.353-.354-.354.354a.512.512 0 0 1-.013.012A7 7 0 1 1 7 2.071V1.5a.5.5 0 0 1-.5-.5zM8 3a6 6 0 1 0 .001 12A6 6 0 0 0 8 3z" id="mainIconPathAttribute"></path> 
            </svg>
        </div>
        <div class="sidebar-divider">
            Output Controls
        </div>
        <div class="shape-group">
            <button class="shape-group-toggle" onclick="toggleShapeGroup(this);">OutPut Controls</button>
            <div class="shape-group-content">
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="OutPutL">
                    <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-lightbulb" viewBox="0 0 16 16" id="OutPutL"> 
                        <path d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a1.964 1.964 0 0 0-.453-.618A5.984 5.984 0 0 1 2 6zm6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1z" id="mainIconPathAttribute"></path> 
                    </svg>
                </div>
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="Display">
                    <svg xmlns="http://www.w3.org/2000/svg" width="96" height="160" viewBox="-1 -1 12 20" stroke="#FFF" stroke-width=".25">
                        <polygon id="a" fill="#F00" points="1, 1  2, 0  8, 0  9, 1  8, 2  2, 2"/>
                        <polygon id="b" fill="#F00" points="9, 1 10, 2 10, 8  9, 9  8, 8  8, 2"/>
                        <polygon id="c" fill="#F00" points="9, 9 10,10 10,16  9,17  8,16  8,10"/>
                        <polygon id="d" fill="#F00" points="9,17  8,18  2,18  1,17  2,16  8,16"/>
                        <polygon id="e" fill="#F00" points="1,17  0,16  0,10  1, 9  2,10  2,16"/>
                        <polygon id="f" fill="#F00" points="1, 9  0, 8  0, 2  1, 1  2, 2  2, 8"/>
                        <polygon id="g" fill="#F00" points="1, 9  2, 8  8, 8  9, 9  8,10  2,10"/>
                    </svg>
                </div>
            </div>
        </div>
        <div class="sidebar-divider">
            Logic Gates
        </div>
        <div class="shape-group">
            <button class="shape-group-toggle" onclick="toggleShapeGroup(this);">Type AND Logic Gates</button>
            <div class="shape-group-content">
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="AND">
                    <svg id="AND" xmlns="http://www.w3.org/2000/svg" width="100" height="50" >
                        <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M31 15H5M32 35H5"/>
                        <path d="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z" />
                    </svg>
                </div>
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="AND3">
                    <svg id="AND3" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                        <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M31 15H5M32 35H5"/>
                        <path d="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z" />
                        <line x1="5" y1="25" x2="30" y2="25" stroke="#000" stroke-width="2" />
                    </svg>
                </div>
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="AND4">
                <svg id="AND4" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                    <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M31 15H5M32 35H5"/>
                    <path d="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z" />
                    <line x1="5" y1="22" x2="30" y2="22" stroke="#000" stroke-width="2" />
                    <line x1="5" y1="28" x2="30" y2="28" stroke="#000" stroke-width="2" />
                </svg>
                </div>
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="AND5">
                    <svg id="AND5" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                        <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M31 15H5M32 35H5"/>
                        <path d="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z" />
                        <line x1="5" y1="20" x2="30" y2="20" stroke="#000" stroke-width="2" />
                        <line x1="5" y1="25" x2="30" y2="25" stroke="#000" stroke-width="2" />
                        <line x1="5" y1="30" x2="30" y2="30" stroke="#000" stroke-width="2" />
                    </svg>
                </div>
            </div>
        </div>
        <div class="shape-group">
            <button class="shape-group-toggle" onclick="toggleShapeGroup(this);">Type OR Logic Gates</button>
            <div class="shape-group-content">
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="OR">
                    <svg id="OR" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                        <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M31 15H5M32 35H5"/>
                        <path fill-rule="evenodd" d="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"/>
                    </svg>
                </div>
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="OR3">
                    <svg id="OR3" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                        <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M31 15H5M32 35H5"/>
                        <path fill-rule="evenodd" d="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"/>
                        <!-- Agregamos la línea en el centro -->
                        <line x1="5" y1="25" x2="30" y2="25" stroke="#000" stroke-width="2" />
                    </svg>
                </div>
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="OR4">
                    <svg id="OR4" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                        <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M31 15H5M32 35H5"/>
                        <path fill-rule="evenodd" d="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"/>
                        <line x1="5" y1="22" x2="30" y2="22" stroke="#000" stroke-width="2" />
                        <line x1="5" y1="28" x2="30" y2="28" stroke="#000" stroke-width="2" />
                    </svg>
                </div>
                <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="OR5">
                    <svg id="OR5" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                        <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M31 15H5M32 35H5"/>
                        <path fill-rule="evenodd" d="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"/>
                        <line x1="5" y1="20" x2="30" y2="20" stroke="#000" stroke-width="2" />
                        <line x1="5" y1="25" x2="30" y2="25" stroke="#000" stroke-width="2" />
                        <line x1="5" y1="30" x2="30" y2="30" stroke="#000" stroke-width="2" />
                    </svg>
                </div>
            </div>
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="NOT">
            <svg id="NOT" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                <path fill="none" stroke="#000" stroke-width="2" d="M79.15691 25H95M29.043478 25h-24"/>
                <path d="M28.96875 2.59375v44.8125l2.15625-1.0625 41.03125-20v-2.6875l-41.03125-20-2.15625-1.0625zm3 4.8125L68.09375 25l-36.125 17.59375V7.40625z" style="marker:none"/>
                <path fill="none" stroke="#000" stroke-width="3" d="M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z"  style="marker:none"/>
              </svg>
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="NAND">
            <svg id="NAND" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                <path fill="none" stroke="#000" stroke-width="2" d="M79 25h16M31 15H5M32 35H5"/>
                <path d="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z"/>
                <path fill="none" stroke="#000" stroke-width="3" d="M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z" />
              </svg>
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="NAND3">
            <svg id="NAND3" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                <path fill="none" stroke="#000" stroke-width="2" d="M79 25h16M31 15H5M32 35H5"/>
                <path d="M30 5V45H50.47619c11.267908 0 20-9.000045 20-20s-8.732091-20-20-20H30zm2.857143 2.857143H50.47619c9.760663 0 16.666667 7.639955 16.666667 17.142857 0 9.502902-7.382195 17.142857-17.142857 17.142857H32.857143V7.857143z"/>
                <path fill="none" stroke="#000" stroke-width="3" d="M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z" />
                <line x1="5" y1="25" x2="30" y2="25" stroke="#000" stroke-width="2" />
              </svg>
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="NOR">
            <svg id="NOR" xmlns="http://www.w3.org/2000/svg" width="100" height="50" >
                <path fill="none" stroke="#000" stroke-width="2" d="M79 25h16M31 15H5M32 35H5"/>
                <path fill-rule="evenodd" d="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"/>
                <path fill="none" stroke="#000" stroke-width="3" d="M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z" style="marker:none"/>
              </svg>        
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="NOR3">
            <svg id="NOR3" xmlns="http://www.w3.org/2000/svg" width="100" height="50" >
                <path fill="none" stroke="#000" stroke-width="2" d="M79 25h16M31 15H5M32 35H5"/>
                <path fill-rule="evenodd" d="M24.09375 5l2 2.4375S31.75 14.437549 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.408076.000001 7.689699.024514 13.625-2.40625s12.536536-7.343266 17.6875-16.875L71.25 25l1.3125-.71875C62.259387 5.21559 46.006574 5 41.25 5H24.09375zm5.875 3H41.25c4.684173 0 18.28685-.130207 27.96875 17C64.451964 33.429075 58.697469 37.68391 53.5 39.8125 48.139339 42.007924 43.658075 42.000001 41.25 42H30c1.873588-3.108434 4.75-9.04935 4.75-17 0-7.973354-2.908531-13.900185-4.78125-17z"/>
                <path fill="none" stroke="#000" stroke-width="3" d="M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z" style="marker:none"/>
                <line x1="5" y1="25" x2="30" y2="25" stroke="#000" stroke-width="2" />
              </svg>        
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="XOR">
            <svg id="XOR" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M30.38572 15H5M31.3621 35H5"/>
                <g fill-rule="evenodd">
                  <path d="M24.25 42C22.65263 44.6444 22 45 22 45h-3.65625l2-2.4375S26 35.56245 26 25 20.34375 7.4375 20.34375 7.4375l-2-2.4375H22c.78125.9375 1.42188 1.65625 2.21875 3C26.09147 11.09981 29 17.02665 29 25c0 7.95065-2.8967 13.87942-4.75 17z"/>
                  <path d="M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375zm5.875 3H41.25c4.68417 0 18.28685-.1302 27.96875 17C64.45196 33.42907 58.69747 37.68391 53.5 39.8125 48.13934 42.00792 43.65808 42 41.25 42H30c1.87359-3.10843 4.75-9.04935 4.75-17 0-7.97335-2.90853-13.90019-4.78125-17z"/>
                </g>
            </svg>        
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="XNOR">
            <svg id="XNOR" xmlns="http://www.w3.org/2000/svg" width="100" height="50">
                <path fill="none" stroke="#000" stroke-width="2" d="M70 25h25M30.38572 15H5M31.3621 35H5"/>
                <g fill-rule="evenodd">
                    <path d="M24.25 42C22.65263 44.6444 22 45 22 45h-3.65625l2-2.4375S26 35.56245 26 25 20.34375 7.4375 20.34375 7.4375l-2-2.4375H22c.78125.9375 1.42188 1.65625 2.21875 3C26.09147 11.09981 29 17.02665 29 25c0 7.95065-2.8967 13.87942-4.75 17z"/>
                    <path d="M24.09375 5l2 2.4375S31.75 14.43755 31.75 25s-5.65625 17.5625-5.65625 17.5625l-2 2.4375H41.25c2.40808 0 7.6897.02451 13.625-2.40625s12.53654-7.34327 17.6875-16.875L71.25 25l1.3125-.71875C62.25939 5.21559 46.00657 5 41.25 5H24.09375zm5.875 3H41.25c4.68417 0 18.28685-.1302 27.96875 17C64.45196 33.42907 58.69747 37.68391 53.5 39.8125 48.13934 42.00792 43.65808 42 41.25 42H30c1.87359-3.10843 4.75-9.04935 4.75-17 0-7.97335-2.90853-13.90019-4.78125-17z"/>
                    <path fill="none" stroke="#000" stroke-width="3" d="M79 25a4 4 0 1 1-8 0 4 4 0 1 1 8 0z" style="marker:none"/>
                </g>
            </svg>      
        </div>
        <div class="sidebar-divider">
            Flip Flops
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="SR_Flip_Flop">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
            <!-- Created with Inkscape (http://www.inkscape.org/) -->
            <svg
            xmlns:dc="http://purl.org/dc/elements/1.1/"
            xmlns:cc="http://creativecommons.org/ns#"
            xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
            xmlns:svg="http://www.w3.org/2000/svg"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
            width="100"
            height="100"
            id="SR_Flip_Flop"
            sodipodi:version="0.32"
            inkscape:version="0.46"
            version="1.0"
            sodipodi:docbase="C:\Program Files\Inkscape"
            sodipodi:docname="SR Flip-flop Symbol.svg"
            inkscape:output_extension="org.inkscape.output.svg.inkscape">
            <defs
                id="defs4">
                <inkscape:perspective
                sodipodi:type="inkscape:persp3d"
                inkscape:vp_x="0 : 50 : 1"
                inkscape:vp_y="0 : 1000 : 0"
                inkscape:vp_z="100 : 50 : 1"
                inkscape:persp3d-origin="50 : 33.333333 : 1"
                id="perspective3848" />
            </defs>
            <sodipodi:namedview
                id="base"
                pagecolor="#ffffff"
                bordercolor="#666666"
                borderopacity="1.0"
                inkscape:pageopacity="0.0"
                inkscape:pageshadow="2"
                inkscape:zoom="4"
                inkscape:cx="30.701454"
                inkscape:cy="42.37202"
                inkscape:document-units="px"
                inkscape:current-layer="g4867"
                showgrid="true"
                inkscape:grid-bbox="true"
                inkscape:grid-points="true"
                showguides="true"
                inkscape:guide-bbox="true"
                gridtolerance="5px"
                inkscape:window-width="1024"
                inkscape:window-height="712"
                inkscape:window-x="129"
                inkscape:window-y="116"
                inkscape:snap-bbox="true"
                objecttolerance="11">
                <inkscape:grid
                id="GridFromPre046Settings"
                type="xygrid"
                originx="0px"
                originy="0px"
                spacingx="5px"
                spacingy="5px"
                color="#0000ff"
                empcolor="#0000ff"
                opacity="0.2"
                empopacity="0.4"
                empspacing="5"
                visible="true"
                enabled="true" />
            </sodipodi:namedview>
            <metadata
                id="metadata7">
                <rdf:RDF>
                <cc:Work
                    rdf:about="">
                    <dc:format>image/svg+xml</dc:format>
                    <dc:type
                    rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                </cc:Work>
                </rdf:RDF>
            </metadata>
            <g
                inkscape:label="Layer 1"
                inkscape:groupmode="layer"
                id="layer1">
                <g
                id="g4867"
                style="fill:none">
                <rect
                    y="11.500001"
                    x="21.499998"
                    height="77"
                    width="56.999996"
                    id="rect1311"
                    style="opacity:1;fill:none;fill-opacity:0.03703703;stroke:#000000;stroke-width:2.99999952;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
                <path
                    id="path3085"
                    d="M 21,30 L 5,30"
                    style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                    sodipodi:nodetypes="cc" />
                <path
                    id="path3087"
                    d="M 21,70 L 5,70"
                    style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                    sodipodi:nodetypes="cc" />
                <path
                    id="path3089"
                    d="M 79,70 L 95,70"
                    style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                    sodipodi:nodetypes="cc" />
                <path
                    id="path3091"
                    d="M 79,30 L 95,30"
                    style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                    sodipodi:nodetypes="cc" />
                </g>
                <path
                sodipodi:nodetypes="cc"
                style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                d="M 63.806565,62 L 73.306565,62"
                id="path3081" />
                <text
                xml:space="preserve"
                style="font-size:14;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                x="35.890625"
                y="34.773438"
                id="text3850"
                sodipodi:linespacing="100%"><tspan
                    sodipodi:role="line"
                    id="tspan3852"
                    x="35.890625"
                    y="34.773438">S</tspan></text>
                <text
                xml:space="preserve"
                style="font-size:14;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                x="36.372707"
                y="75"
                id="text3854"
                sodipodi:linespacing="100%"><tspan
                    sodipodi:role="line"
                    id="tspan3856"
                    x="36.372707"
                    y="75">R</tspan></text>
                <text
                xml:space="preserve"
                style="font-size:14;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                x="73.907623"
                y="35"
                id="text3858"
                sodipodi:linespacing="100%"><tspan
                    sodipodi:role="line"
                    id="tspan3860"
                    x="73.907623"
                    y="35">Q</tspan></text>
                <text
                xml:space="preserve"
                style="font-size:14;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                x="73.825577"
                y="75"
                id="text3863"
                sodipodi:linespacing="100%"><tspan
                    sodipodi:role="line"
                    id="tspan3865"
                    x="73.825577"
                    y="75">Q</tspan></text>
            </g>
            </svg>

        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="D_Flip_Flop">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="100"
   height="100"
   id="D_Flip_Flop"
   sodipodi:version="0.32"
   inkscape:version="0.46"
   version="1.0"
   sodipodi:docbase="C:\Program Files\Inkscape"
   sodipodi:docname="D Flip-flop Symbol.svg"
   inkscape:output_extension="org.inkscape.output.svg.inkscape">
  <defs
     id="defs4">
    <inkscape:perspective
       sodipodi:type="inkscape:persp3d"
       inkscape:vp_x="0 : 50 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_z="100 : 50 : 1"
       inkscape:persp3d-origin="50 : 33.333333 : 1"
       id="perspective3848" />
  </defs>
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="2"
     inkscape:cx="26.836729"
     inkscape:cy="36.81932"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="true"
     inkscape:grid-bbox="true"
     inkscape:grid-points="true"
     showguides="true"
     inkscape:guide-bbox="true"
     gridtolerance="5px"
     inkscape:window-width="1024"
     inkscape:window-height="712"
     inkscape:window-x="129"
     inkscape:window-y="116"
     inkscape:snap-bbox="true"
     objecttolerance="11">
    <inkscape:grid
       id="GridFromPre046Settings"
       type="xygrid"
       originx="0px"
       originy="0px"
       spacingx="5px"
       spacingy="5px"
       color="#0000ff"
       empcolor="#0000ff"
       opacity="0.2"
       empopacity="0.4"
       empspacing="5"
       visible="true"
       enabled="true" />
  </sodipodi:namedview>
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1">
    <g
       id="g4867"
       style="fill:none">
      <rect
         y="11.500001"
         x="21.499998"
         height="77"
         width="56.999996"
         id="rect1311"
         style="opacity:1;fill:none;fill-opacity:0.03703703;stroke:#000000;stroke-width:2.99999952;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
      <path
         id="path3085"
         d="M 21,30 L 5,30"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
         sodipodi:nodetypes="cc" />
      <path
         id="path3087"
         d="M 21,70 L 5,70"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
         sodipodi:nodetypes="cc" />
      <path
         id="path3089"
         d="M 79,70 L 95,70"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
         sodipodi:nodetypes="cc" />
      <path
         id="path3091"
         d="M 79,30 L 95,30"
         style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
         sodipodi:nodetypes="cc" />
    </g>
    <path
       sodipodi:nodetypes="cc"
       style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
       d="M 63.806565,62 L 73.306565,62"
       id="path3081" />
    <text
       xml:space="preserve"
       style="font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
       x="35.890625"
       y="34.773438"
       id="text3850"
       sodipodi:linespacing="100%"><tspan
         sodipodi:role="line"
         id="tspan3852"
         x="35.890625"
         y="34.773438">D</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:14;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
       x="73.907623"
       y="35"
       id="text3858"
       sodipodi:linespacing="100%"><tspan
         sodipodi:role="line"
         id="tspan3860"
         x="73.907623"
         y="35">Q</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:14;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
       x="73.825577"
       y="75"
       id="text3863"
       sodipodi:linespacing="100%"><tspan
         sodipodi:role="line"
         id="tspan3865"
         x="73.825577"
         y="75">Q</tspan></text>
    <path
       style="opacity:1;fill:none;fill-opacity:1;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
       d="M 21.0625,65 L 32.5625,70 L 21.0625,75"
       id="path3888"
       sodipodi:nodetypes="ccc" />
  </g>
</svg>

        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="T_Flip_Flop">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
            <!-- Created with Inkscape (http://www.inkscape.org/) -->
            <svg
               xmlns:dc="http://purl.org/dc/elements/1.1/"
               xmlns:cc="http://creativecommons.org/ns#"
               xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
               xmlns:svg="http://www.w3.org/2000/svg"
               xmlns="http://www.w3.org/2000/svg"
               xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
               xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
               width="100"
               height="100"
               id="T_Flip_Flop"
               sodipodi:version="0.32"
               inkscape:version="0.46"
               version="1.0"
               sodipodi:docbase="C:\Program Files\Inkscape"
               sodipodi:docname="T Flip-flop Symbol.svg"
               inkscape:output_extension="org.inkscape.output.svg.inkscape">
              <defs
                 id="defs4">
                <inkscape:perspective
                   sodipodi:type="inkscape:persp3d"
                   inkscape:vp_x="0 : 50 : 1"
                   inkscape:vp_y="0 : 1000 : 0"
                   inkscape:vp_z="100 : 50 : 1"
                   inkscape:persp3d-origin="50 : 33.333333 : 1"
                   id="perspective3848" />
              </defs>
              <sodipodi:namedview
                 id="base"
                 pagecolor="#ffffff"
                 bordercolor="#666666"
                 borderopacity="1.0"
                 inkscape:pageopacity="0.0"
                 inkscape:pageshadow="2"
                 inkscape:zoom="2"
                 inkscape:cx="26.836729"
                 inkscape:cy="36.81932"
                 inkscape:document-units="px"
                 inkscape:current-layer="layer1"
                 showgrid="true"
                 inkscape:grid-bbox="true"
                 inkscape:grid-points="true"
                 showguides="true"
                 inkscape:guide-bbox="true"
                 gridtolerance="5px"
                 inkscape:window-width="1024"
                 inkscape:window-height="712"
                 inkscape:window-x="129"
                 inkscape:window-y="116"
                 inkscape:snap-bbox="true"
                 objecttolerance="11">
                <inkscape:grid
                   id="GridFromPre046Settings"
                   type="xygrid"
                   originx="0px"
                   originy="0px"
                   spacingx="5px"
                   spacingy="5px"
                   color="#0000ff"
                   empcolor="#0000ff"
                   opacity="0.2"
                   empopacity="0.4"
                   empspacing="5"
                   visible="true"
                   enabled="true" />
              </sodipodi:namedview>
              <metadata
                 id="metadata7">
                <rdf:RDF>
                  <cc:Work
                     rdf:about="">
                    <dc:format>image/svg+xml</dc:format>
                    <dc:type
                       rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                  </cc:Work>
                </rdf:RDF>
              </metadata>
              <g
                 inkscape:label="Layer 1"
                 inkscape:groupmode="layer"
                 id="layer1">
                <g
                   id="g4867"
                   style="fill:none">
                  <rect
                     y="11.500001"
                     x="21.499998"
                     height="77"
                     width="56.999996"
                     id="rect1311"
                     style="opacity:1;fill:none;fill-opacity:0.03703703;stroke:#000000;stroke-width:2.99999952;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
                  <path
                     id="path3085"
                     d="M 21,30 L 5,30"
                     style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                     sodipodi:nodetypes="cc" />
                  <path
                     id="path3087"
                     d="M 21,70 L 5,70"
                     style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                     sodipodi:nodetypes="cc" />
                  <path
                     id="path3089"
                     d="M 79,70 L 95,70"
                     style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                     sodipodi:nodetypes="cc" />
                  <path
                     id="path3091"
                     d="M 79,30 L 95,30"
                     style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                     sodipodi:nodetypes="cc" />
                </g>
                <path
                   sodipodi:nodetypes="cc"
                   style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                   d="M 63.806565,62 L 73.306565,62"
                   id="path3081" />
                <text
                   xml:space="preserve"
                   style="font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                   x="35.890625"
                   y="34.773438"
                   id="text3850"
                   sodipodi:linespacing="100%"><tspan
                     sodipodi:role="line"
                     id="tspan3852"
                     x="35.890625"
                     y="34.773438">T</tspan></text>
                <text
                   xml:space="preserve"
                   style="font-size:14;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                   x="73.907623"
                   y="35"
                   id="text3858"
                   sodipodi:linespacing="100%"><tspan
                     sodipodi:role="line"
                     id="tspan3860"
                     x="73.907623"
                     y="35">Q</tspan></text>
                <text
                   xml:space="preserve"
                   style="font-size:14;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                   x="73.825577"
                   y="75"
                   id="text3863"
                   sodipodi:linespacing="100%"><tspan
                     sodipodi:role="line"
                     id="tspan3865"
                     x="73.825577"
                     y="75">Q</tspan></text>
                <path
                   style="opacity:1;fill:none;fill-opacity:1;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                   d="M 21.0625,65 L 32.5625,70 L 21.0625,75"
                   id="path3888"
                   sodipodi:nodetypes="ccc" />
              </g>
            </svg>
                       
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="JK_Flip_Flop">
            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
            <!-- Created with Inkscape (http://www.inkscape.org/) -->
            <svg
               xmlns:dc="http://purl.org/dc/elements/1.1/"
               xmlns:cc="http://creativecommons.org/ns#"
               xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
               xmlns:svg="http://www.w3.org/2000/svg"
               xmlns="http://www.w3.org/2000/svg"
               xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
               xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
               width="100"
               height="100"
               id="JK_Flip_Flop"
               sodipodi:version="0.32"
               inkscape:version="0.46"
               version="1.0"
               sodipodi:docbase="C:\Program Files\Inkscape"
               sodipodi:docname="JK Flip-flop Symbol.svg"
               inkscape:output_extension="org.inkscape.output.svg.inkscape">
              <defs
                 id="defs4">
                <inkscape:perspective
                   sodipodi:type="inkscape:persp3d"
                   inkscape:vp_x="0 : 50 : 1"
                   inkscape:vp_y="0 : 1000 : 0"
                   inkscape:vp_z="100 : 50 : 1"
                   inkscape:persp3d-origin="50 : 33.333333 : 1"
                   id="perspective3848" />
              </defs>
              <sodipodi:namedview
                 id="base"
                 pagecolor="#ffffff"
                 bordercolor="#666666"
                 borderopacity="1.0"
                 inkscape:pageopacity="0.0"
                 inkscape:pageshadow="2"
                 inkscape:zoom="4"
                 inkscape:cx="35.223932"
                 inkscape:cy="50.283722"
                 inkscape:document-units="px"
                 inkscape:current-layer="layer1"
                 showgrid="true"
                 inkscape:grid-bbox="true"
                 inkscape:grid-points="true"
                 showguides="true"
                 inkscape:guide-bbox="true"
                 gridtolerance="5px"
                 inkscape:window-width="1024"
                 inkscape:window-height="712"
                 inkscape:window-x="94"
                 inkscape:window-y="107"
                 inkscape:snap-bbox="true"
                 objecttolerance="11">
                <inkscape:grid
                   id="GridFromPre046Settings"
                   type="xygrid"
                   originx="0px"
                   originy="0px"
                   spacingx="5px"
                   spacingy="5px"
                   color="#0000ff"
                   empcolor="#0000ff"
                   opacity="0.2"
                   empopacity="0.4"
                   empspacing="5"
                   visible="true"
                   enabled="true" />
              </sodipodi:namedview>
              <metadata
                 id="metadata7">
                <rdf:RDF>
                  <cc:Work
                     rdf:about="">
                    <dc:format>image/svg+xml</dc:format>
                    <dc:type
                       rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                  </cc:Work>
                </rdf:RDF>
              </metadata>
              <g
                 inkscape:label="Layer 1"
                 inkscape:groupmode="layer"
                 id="layer1">
                <g
                   id="g4867"
                   style="fill:none">
                  <rect
                     y="11.500001"
                     x="21.499998"
                     height="77"
                     width="56.999996"
                     id="rect1311"
                     style="opacity:1;fill:none;fill-opacity:0.03703703;stroke:#000000;stroke-width:2.99999952;stroke-linecap:square;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1" />
                  <path
                     id="path3085"
                     d="M 21,30 L 5,30"
                     style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                     sodipodi:nodetypes="cc" />
                  <path
                     id="path3087"
                     d="M 21,70 L 5,70"
                     style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                     sodipodi:nodetypes="cc" />
                  <path
                     id="path3089"
                     d="M 79,70 L 95,70"
                     style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                     sodipodi:nodetypes="cc" />
                  <path
                     id="path3091"
                     d="M 79,30 L 95,30"
                     style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                     sodipodi:nodetypes="cc" />
                  <path
                     id="path4659"
                     d="M 21,50 L 5,50"
                     style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                     sodipodi:nodetypes="cc" />
                </g>
                <path
                   sodipodi:nodetypes="cc"
                   style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                   d="M 63.806565,62 L 73.306565,62"
                   id="path3081" />
                <text
                   xml:space="preserve"
                   style="font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                   x="33.890625"
                   y="34.773438"
                   id="text3850"
                   sodipodi:linespacing="100%"><tspan
                     sodipodi:role="line"
                     id="tspan3852"
                     x="33.890625"
                     y="34.773438">J</tspan></text>
                <text
                   xml:space="preserve"
                   style="font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                   x="73.907623"
                   y="35"
                   id="text3858"
                   sodipodi:linespacing="100%"><tspan
                     sodipodi:role="line"
                     id="tspan3860"
                     x="73.907623"
                     y="35">Q</tspan></text>
                <text
                   xml:space="preserve"
                   style="font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                   x="73.825577"
                   y="75"
                   id="text3863"
                   sodipodi:linespacing="100%"><tspan
                     sodipodi:role="line"
                     id="tspan3865"
                     x="73.825577"
                     y="75">Q</tspan></text>
                <path
                   style="opacity:1;fill:none;fill-opacity:1;stroke:#000000;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"
                   d="M 21.0625,45 L 32.5625,50 L 21.0625,55"
                   id="path3888"
                   sodipodi:nodetypes="ccc" />
                <text
                   sodipodi:linespacing="100%"
                   id="text4661"
                   y="75"
                   x="35.702469"
                   style="font-size:14px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:100%;writing-mode:lr-tb;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;font-family:DejaVu Sans;-inkscape-font-specification:DejaVu Sans"
                   xml:space="preserve"><tspan
                     y="75"
                     x="35.702469"
                     id="tspan4663"
                     sodipodi:role="line">K</tspan></text>
              </g>
            </svg>
            
        </div>
        <div class="sidebar-divider">
            IC Components
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="Pin14">
            <svg width="40" height="60" xmlns="http://www.w3.org/2000/svg" id="IC7400">
                <g>
                 <title>7 Decoder</title>
                 <rect stroke="#000" id="svg_1" height="48.62498" width="25.62499" y="5.40001" x="7.34999" fill="#fff"/>
                 <rect stroke="#000" id="svg_3" height="0" width="2.99999" y="16.9999" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_4" height="1.75" width="2.99999" y="14.74991" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_5" height="1.625" width="2.99999" y="22.1249" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_6" height="1.625" width="2.99999" y="28.87488" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_7" height="1.75" width="2.99999" y="8.49992" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_8" height="1.625" width="2.99999" y="35.74987" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_9" height="1.625" width="2.99999" y="42.37486" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_10" height="1.625" width="2.99999" y="49.24984" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_11" height="1.75" width="2.99999" y="8.74992" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_12" height="1.75" width="2.99999" y="15.12491" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_13" height="1.75" width="2.99999" y="21.9999" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_14" height="1.75" width="2.99999" y="29.24988" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_15" height="1.75" width="2.99999" y="36.24987" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_16" height="1.75" width="2.99999" y="42.49986" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_17" height="1.75" width="2.99999" y="48.74984" x="33.87497" fill="#fff"/>
                 <ellipse ry="2.25" rx="2.25" id="svg_18" cy="9.74992" cx="20" stroke="#000" fill="#fff"/>
                 <text x="10" y="30" fill="#000"  font-size="6px" font-weight="bold">7 Decoder</text>
                </g>
            </svg>
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="IC7408">
            <svg width="40" height="60" xmlns="http://www.w3.org/2000/svg" id="IC7408">
                <g>
                 <title>IC 7408 AND</title>
                 <rect stroke="#000" id="svg_1" height="48.62498" width="25.62499" y="5.40001" x="7.34999" fill="#fff"/>
                 <rect stroke="#000" id="svg_3" height="0" width="2.99999" y="16.9999" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_4" height="1.75" width="2.99999" y="14.74991" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_5" height="1.625" width="2.99999" y="22.1249" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_6" height="1.625" width="2.99999" y="28.87488" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_7" height="1.75" width="2.99999" y="8.49992" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_8" height="1.625" width="2.99999" y="35.74987" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_9" height="1.625" width="2.99999" y="42.37486" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_10" height="1.625" width="2.99999" y="49.24984" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_11" height="1.75" width="2.99999" y="8.74992" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_12" height="1.75" width="2.99999" y="15.12491" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_13" height="1.75" width="2.99999" y="21.9999" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_14" height="1.75" width="2.99999" y="29.24988" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_15" height="1.75" width="2.99999" y="36.24987" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_16" height="1.75" width="2.99999" y="42.49986" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_17" height="1.75" width="2.99999" y="48.74984" x="33.87497" fill="#fff"/>
                 <ellipse ry="2.25" rx="2.25" id="svg_18" cy="9.74992" cx="20" stroke="#000" fill="#fff"/>
                </g>
                <text x="10" y="30" fill="#000"  font-size="6px" font-weight="bold">IC 7408</text>
            </svg>
        </div>     
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="IC7400">
            <svg width="40" height="60" xmlns="http://www.w3.org/2000/svg" id="IC7400">
                <g>
                 <title>IC 7400 NAND</title>
                 <rect stroke="#000" id="svg_1" height="48.62498" width="25.62499" y="5.40001" x="7.34999" fill="#fff"/>
                 <rect stroke="#000" id="svg_3" height="0" width="2.99999" y="16.9999" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_4" height="1.75" width="2.99999" y="14.74991" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_5" height="1.625" width="2.99999" y="22.1249" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_6" height="1.625" width="2.99999" y="28.87488" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_7" height="1.75" width="2.99999" y="8.49992" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_8" height="1.625" width="2.99999" y="35.74987" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_9" height="1.625" width="2.99999" y="42.37486" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_10" height="1.625" width="2.99999" y="49.24984" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_11" height="1.75" width="2.99999" y="8.74992" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_12" height="1.75" width="2.99999" y="15.12491" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_13" height="1.75" width="2.99999" y="21.9999" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_14" height="1.75" width="2.99999" y="29.24988" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_15" height="1.75" width="2.99999" y="36.24987" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_16" height="1.75" width="2.99999" y="42.49986" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_17" height="1.75" width="2.99999" y="48.74984" x="33.87497" fill="#fff"/>
                 <ellipse ry="2.25" rx="2.25" id="svg_18" cy="9.74992" cx="20" stroke="#000" fill="#fff"/>
                </g>
                <text x="10" y="30" fill="#000"  font-size="6px" font-weight="bold">IC 7400</text>
            </svg>
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="IC7432">
            <svg width="40" height="60" xmlns="http://www.w3.org/2000/svg" id="IC7432">
                <g>
                 <title>IC 7432 OR</title>
                 <rect stroke="#000" id="svg_1" height="48.62498" width="25.62499" y="5.40001" x="7.34999" fill="#fff"/>
                 <rect stroke="#000" id="svg_3" height="0" width="2.99999" y="16.9999" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_4" height="1.75" width="2.99999" y="14.74991" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_5" height="1.625" width="2.99999" y="22.1249" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_6" height="1.625" width="2.99999" y="28.87488" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_7" height="1.75" width="2.99999" y="8.49992" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_8" height="1.625" width="2.99999" y="35.74987" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_9" height="1.625" width="2.99999" y="42.37486" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_10" height="1.625" width="2.99999" y="49.24984" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_11" height="1.75" width="2.99999" y="8.74992" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_12" height="1.75" width="2.99999" y="15.12491" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_13" height="1.75" width="2.99999" y="21.9999" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_14" height="1.75" width="2.99999" y="29.24988" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_15" height="1.75" width="2.99999" y="36.24987" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_16" height="1.75" width="2.99999" y="42.49986" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_17" height="1.75" width="2.99999" y="48.74984" x="33.87497" fill="#fff"/>
                 <ellipse ry="2.25" rx="2.25" id="svg_18" cy="9.74992" cx="20" stroke="#000" fill="#fff"/>
                </g>
                <text x="10" y="30" fill="#000"  font-size="6px" font-weight="bold">IC 7432</text>
            </svg>
        </div>                         
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="IC7402">
            <svg width="40" height="60" xmlns="http://www.w3.org/2000/svg" id="IC7402">
                <g>
                 <title>IC 7402 NOR</title>
                 <rect stroke="#000" id="svg_1" height="48.62498" width="25.62499" y="5.40001" x="7.34999" fill="#fff"/>
                 <rect stroke="#000" id="svg_3" height="0" width="2.99999" y="16.9999" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_4" height="1.75" width="2.99999" y="14.74991" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_5" height="1.625" width="2.99999" y="22.1249" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_6" height="1.625" width="2.99999" y="28.87488" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_7" height="1.75" width="2.99999" y="8.49992" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_8" height="1.625" width="2.99999" y="35.74987" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_9" height="1.625" width="2.99999" y="42.37486" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_10" height="1.625" width="2.99999" y="49.24984" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_11" height="1.75" width="2.99999" y="8.74992" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_12" height="1.75" width="2.99999" y="15.12491" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_13" height="1.75" width="2.99999" y="21.9999" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_14" height="1.75" width="2.99999" y="29.24988" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_15" height="1.75" width="2.99999" y="36.24987" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_16" height="1.75" width="2.99999" y="42.49986" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_17" height="1.75" width="2.99999" y="48.74984" x="33.87497" fill="#fff"/>
                 <ellipse ry="2.25" rx="2.25" id="svg_18" cy="9.74992" cx="20" stroke="#000" fill="#fff"/>
                </g>
                <text x="10" y="30" fill="#000"  font-size="6px" font-weight="bold">IC 7402</text>
            </svg>
        </div>
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="IC7486">
            <svg width="40" height="60" xmlns="http://www.w3.org/2000/svg" id="IC7486">
                <g>
                 <title>IC 7486 XOR</title>
                 <rect stroke="#000" id="svg_1" height="48.62498" width="25.62499" y="5.40001" x="7.34999" fill="#fff"/>
                 <rect stroke="#000" id="svg_3" height="0" width="2.99999" y="16.9999" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_4" height="1.75" width="2.99999" y="14.74991" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_5" height="1.625" width="2.99999" y="22.1249" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_6" height="1.625" width="2.99999" y="28.87488" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_7" height="1.75" width="2.99999" y="8.49992" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_8" height="1.625" width="2.99999" y="35.74987" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_9" height="1.625" width="2.99999" y="42.37486" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_10" height="1.625" width="2.99999" y="49.24984" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_11" height="1.75" width="2.99999" y="8.74992" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_12" height="1.75" width="2.99999" y="15.12491" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_13" height="1.75" width="2.99999" y="21.9999" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_14" height="1.75" width="2.99999" y="29.24988" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_15" height="1.75" width="2.99999" y="36.24987" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_16" height="1.75" width="2.99999" y="42.49986" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_17" height="1.75" width="2.99999" y="48.74984" x="33.87497" fill="#fff"/>
                 <ellipse ry="2.25" rx="2.25" id="svg_18" cy="9.74992" cx="20" stroke="#000" fill="#fff"/>
                </g>
                <text x="10" y="30" fill="#000"  font-size="6px" font-weight="bold">IC 7486</text>
            </svg>
        </div>    
        <div class="shape-item" draggable="true" ondragstart="drag(event)" data-shape-type="IC7404">
            <svg width="40" height="60" xmlns="http://www.w3.org/2000/svg" id="IC7404">
                <g>
                 <title>IC 7404 NOT</title>
                 <rect stroke="#000" id="svg_1" height="48.62498" width="25.62499" y="5.40001" x="7.34999" fill="#fff"/>
                 <rect stroke="#000" id="svg_3" height="0" width="2.99999" y="16.9999" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_4" height="1.75" width="2.99999" y="14.74991" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_5" height="1.625" width="2.99999" y="22.1249" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_6" height="1.625" width="2.99999" y="28.87488" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_7" height="1.75" width="2.99999" y="8.49992" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_8" height="1.625" width="2.99999" y="35.74987" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_9" height="1.625" width="2.99999" y="42.37486" x="3.50003" fill="#fff"/>
                 <rect stroke="#000" id="svg_10" height="1.625" width="2.99999" y="49.24984" x="3.37503" fill="#fff"/>
                 <rect stroke="#000" id="svg_11" height="1.75" width="2.99999" y="8.74992" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_12" height="1.75" width="2.99999" y="15.12491" x="33.87497" fill="#fff"/>
                 <rect stroke="#000" id="svg_13" height="1.75" width="2.99999" y="21.9999" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_14" height="1.75" width="2.99999" y="29.24988" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_15" height="1.75" width="2.99999" y="36.24987" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_16" height="1.75" width="2.99999" y="42.49986" x="33.99997" fill="#fff"/>
                 <rect stroke="#000" id="svg_17" height="1.75" width="2.99999" y="48.74984" x="33.87497" fill="#fff"/>
                 <ellipse ry="2.25" rx="2.25" id="svg_18" cy="9.74992" cx="20" stroke="#000" fill="#fff"/>
                </g>
                <text x="10" y="30" fill="#000"  font-size="6px" font-weight="bold">IC 7404</text>
            </svg>
        </div>           
    </div>
    <section id="wrapper">
        <nav class="navbar navbar-expand-md">
            <div class="navbar-header">
                <span style="color: #fff;"><b>&nbsp;&nbsp;&nbsp;Logic&nbsp;Gates</b></span><span class="main-color">&nbsp;Lab</span>
                <span style="color: #fff;">&nbsp;&nbsp;&nbsp;Save to:<input type="text" id="fileName" placeholder="Untitled" ></span>
            </div>
            <div class="toolbar">
                <button onclick="createNewCircuit()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-file-plus" viewBox="0 0 16 16" id="IconChangeColor"> <path d="M8.5 6a.5.5 0 0 0-1 0v1.5H6a.5.5 0 0 0 0 1h1.5V10a.5.5 0 0 0 1 0V8.5H10a.5.5 0 0 0 0-1H8.5V6z" id="mainIconPathAttribute"></path> <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z" id="mainIconPathAttribute"></path> </svg> 
                </button>
                <button id="loadButton">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-file-arrow-up" viewBox="0 0 16 16" id="IconChangeColor"> <path d="M8 11a.5.5 0 0 0 .5-.5V6.707l1.146 1.147a.5.5 0 0 0 .708-.708l-2-2a.5.5 0 0 0-.708 0l-2 2a.5.5 0 1 0 .708.708L7.5 6.707V10.5a.5.5 0 0 0 .5.5z" id="mainIconPathAttribute"></path> <path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z" id="mainIconPathAttribute"></path> </svg> 
                </button>
                <button Id="saveButton">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-file-arrow-down" viewBox="0 0 16 16" id="IconChangeColor"> <path d="M8 5a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 1 1 .708-.708L7.5 9.293V5.5A.5.5 0 0 1 8 5z" id="mainIconPathAttribute"></path> <path d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z" id="mainIconPathAttribute"></path> </svg> 
                </button>
                <button id="cutButton" onclick="cutSelectedShape()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-file-break" viewBox="0 0 16 16" id="IconChangeColor"> <path d="M0 10.5a.5.5 0 0 1 .5-.5h15a.5.5 0 0 1 0 1H.5a.5.5 0 0 1-.5-.5zM12 0H4a2 2 0 0 0-2 2v7h1V2a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v7h1V2a2 2 0 0 0-2-2zm2 12h-1v2a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-2H2v2a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-2z" id="mainIconPathAttribute"></path> </svg> 
                </button>
                <button id="copyButton" onclick="copySelectedShape()">
                    <svg version="1.1" id="IconChangeColor" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 115.77 122.88" style="enable-background:new 0 0 115.77 122.88" xml:space="preserve" height="25" width="25"><style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style><g><path class="st0" d="M89.62,13.96v7.73h12.19h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02v0.02 v73.27v0.01h-0.02c-0.01,3.84-1.57,7.33-4.1,9.86c-2.51,2.5-5.98,4.06-9.82,4.07v0.02h-0.02h-61.7H40.1v-0.02 c-3.84-0.01-7.34-1.57-9.86-4.1c-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-0.02V92.51H13.96h-0.01v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1 c-2.5-2.51-4.06-5.98-4.07-9.82H0v-0.02V13.96v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07V0h0.02h61.7 h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02V13.96L89.62,13.96z M79.04,21.69v-7.73v-0.02h0.02 c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v64.59v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h12.19V35.65 v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07v-0.02h0.02H79.04L79.04,21.69z M105.18,108.92V35.65v-0.02 h0.02c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v73.27v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h61.7h0.02 v0.02c0.91,0,1.75-0.39,2.37-1.01c0.61-0.61,1-1.46,1-2.37h-0.02V108.92L105.18,108.92z" id="mainIconPathAttribute"></path></g></svg> 
                </button>
                <button id="pasteButton" onclick="pasteShape()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16" id="IconChangeColor"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z" id="mainIconPathAttribute"></path> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z" id="mainIconPathAttribute"></path> </svg> 
                </button>
                <button id="moveUpButton" onclick="moveSelectedShape('up')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-box-arrow-up" viewBox="0 0 16 16" id="IconChangeColor"> <path fill-rule="evenodd" d="M3.5 6a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 1 0-1h2A1.5 1.5 0 0 1 14 6.5v8a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-8A1.5 1.5 0 0 1 3.5 5h2a.5.5 0 0 1 0 1h-2z" id="mainIconPathAttribute"></path> <path fill-rule="evenodd" d="M7.646.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 1.707V10.5a.5.5 0 0 1-1 0V1.707L5.354 3.854a.5.5 0 1 1-.708-.708l3-3z" id="mainIconPathAttribute"></path> </svg> 
                </button>
                <button id="moveDownButton" onclick="moveSelectedShape('down')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-box-arrow-down" viewBox="0 0 16 16" id="IconChangeColor"> <path fill-rule="evenodd" d="M3.5 10a.5.5 0 0 1-.5-.5v-8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0 0 1h2A1.5 1.5 0 0 0 14 9.5v-8A1.5 1.5 0 0 0 12.5 0h-9A1.5 1.5 0 0 0 2 1.5v8A1.5 1.5 0 0 0 3.5 11h2a.5.5 0 0 0 0-1h-2z" id="mainIconPathAttribute"></path> <path fill-rule="evenodd" d="M7.646 15.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 14.293V5.5a.5.5 0 0 0-1 0v8.793l-2.146-2.147a.5.5 0 0 0-.708.708l3 3z" id="mainIconPathAttribute"></path> </svg> 
                </button>
                <button id="moveLeftButton" onclick="moveSelectedShape('left')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-box-arrow-left" viewBox="0 0 16 16" id="IconChangeColor"> <path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z" id="mainIconPathAttribute"></path> <path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z" id="mainIconPathAttribute"></path> </svg> 
                </button>
                <button id="moveRightButton" onclick="moveSelectedShape('right')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16" id="IconChangeColor"> <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z" id="mainIconPathAttribute"></path> <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z" id="mainIconPathAttribute"></path> </svg> 
                </button>
            </div>
        </nav> 
    </section>
            

    <div class="canvas-container">
        <canvas id="myCanvas" width="1500" height="750"></canvas>
    </div>

    <script>

        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');

        // Definir el tamaño de los cuadros en el patrón
        const cuadroSize = 10;

        // Definir colores para las líneas del patrón
        const colorLineaPrincipal = '#e5e4e2'; // Color de las líneas principales (Isabelline)
        const colorLineaSecundaria = '#f4f0ec'; // Color de las líneas secundarias
        const colorRectangulo = '#b2beb5'; // Color de los rectángulos
        const grosorRectangulo = 2; // Grosor de línea de los rectángulos

        // Obtener el tamaño del canvas
        const canvasWidth = canvas.width;
        const canvasHeight = canvas.height;

        // Función para una compuerta NAND
        function andGate(a, b) {
            return (a && b);
        }
        function nandGate(a, b) {
            return !(a && b);
        }
        function orGate(a, b) {
            return (a || b);
        }
        function norGate(a, b) {
            return !(a || b);
        }
        function xorGate(a, b) {
            return (a && !b) || (!a && b);
        }
        function notGate(a) {
            return !(a);
        }

        function logicvalue(value){
            return value?"1":"0";
        }
        function binaryvalue(value){
            return value=="1"?true:false;
        }

        function drawPattern() {
            ctx.clearRect(0, 0, canvasWidth, canvasHeight); // Borrar el canvas

            // Dibujar los puntos
            ctx.fillStyle = colorLineaPrincipal;
            const radioPunto = 2; // Tamaño del radio de los puntos
            for (let x = 0; x <= canvasWidth; x += cuadroSize) {
                for (let y = 0; y <= canvasHeight; y += cuadroSize) {
                    ctx.beginPath();
                    ctx.arc(x, y, radioPunto, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
        }


        // Llama a la función para dibujar el patrón cuadriculado cuando la página se carga
        drawPattern();

        const zoomSlider = document.getElementById('zoomSlider');
        const zoomValue = document.getElementById('zoomValue');
        const canvasContainer = document.querySelector('.canvas-container');

        function zoomCanvas() {
            const zoomLevel = zoomSlider.value;
            zoomValue.textContent = `${zoomLevel}%`;

            // Calcula el nuevo ancho y alto del canvas según el zoom
            const newWidth = (canvas.width * zoomLevel) / 100;
            const newHeight = (canvas.height * zoomLevel) / 100;

            // Actualiza el tamaño del canvas
            canvas.style.width = `${newWidth}px`;
            canvas.style.height = `${newHeight}px`;

            // Permite el overflow en el contenedor del canvas
            canvasContainer.style.overflow = 'auto';

            // Redibuja el contenido del canvas
            redraw();
        }

        function adjustShapes(scale) {
            // Ajusta las coordenadas y el tamaño de las figuras
            for (const shape of shapes) {
                shape.x *= scale;
                shape.y *= scale;
                shape.width *= scale;
                shape.height *= scale;

                for (const output of shape.outputs) {
                    output.x *= scale;
                    output.y *= scale;
                }

                for (const input of shape.inputs) {
                    input.x *= scale;
                    input.y *= scale;
                }
            }
        }

        function adjustCanvasSize(scale) {
            // Actualiza el tamaño del canvas
            canvas.width = canvas.width * scale;
            canvas.height = canvas.height * scale;

            // Ajusta el estilo del canvas para que refleje el nuevo tamaño
            canvas.style.width = `${canvas.width}px`;
            canvas.style.height = `${canvas.height}px`;

            // Habilita el overflow en el contenedor del canvas
            canvasContainer.style.overflow = 'auto';
        }

        function toggleShapeGroup(button) {
            var content = button.nextElementSibling;

            if (content.style.display === "block") {
                content.style.display = "none";
            } else {
                content.style.display = "block";
            }
        }
       

                // URL del JSON
                const jsonUrl = "https://raw.githubusercontent.com/ravendano014/logicgateslab/main/samples/samples.json";

                // Obtener el elemento select
                const selectElement = document.getElementById("elementSelector");

                // Función para llenar el selector con opciones desde el JSON
                function populateSelector(data) {
                    data.forEach(item => {
                        const option = document.createElement("option");
                        option.value = item.url;
                        option.text = item.name;
                        selectElement.appendChild(option);
                    });
                }

                // Obtener el JSON y llenar el selector
                fetch(jsonUrl)
                    .then(response => response.json())
                    .then(data => {
                        populateSelector(data);
                    })
                    .catch(error => {
                        console.error("Error al obtener el JSON:", error);
                    });

                // Función para manejar la selección
                selectElement.addEventListener("change", function() {
                    const selectedUrl = selectElement.value;
                    if (selectedUrl) {
                        // Redirigir o realizar alguna acción con la URL seleccionada
                        loadFromURL(selectedUrl);
                    }
                });




        ctx.lineWidth = 3;

        let isDrawingConnector = false;
        let startShape = null;
        let startOutput = null;
        let endShape = null;
        let endInput = null;
        let shapes = [];
        let connectors = [];

        let isDragging = false;
        let dragStartX = 0;
        let dragStartY = 0;
        let dragOffsetX = 0;
        let dragOffsetY = 0;
        let selectedShape = null;
        let selectedConnector = null;

        canvas.addEventListener('mousedown', (event) => {
            const mouseX = event.offsetX;
            const mouseY = event.offsetY;

            // Verifica si se hizo clic en un output de un shape
            for (const shape of shapes) {
                if(shape.type!="Text"){
                    for (const output of shape.outputs) {
                        if (
                            mouseX >= shape.x + output.x - 6 && mouseX <= shape.x + output.x + 6 &&
                            mouseY >= shape.y + output.y - 6 && mouseY <= shape.y + output.y + 6
                        ) {
                            isDrawingConnector = true;
                            startShape = shape;
                            startOutput = output;
                            return;
                        }
                    }
                }
            }

            // Verifica si se hizo clic en una forma para moverla
            for (const shape of shapes) {
                if (
                    mouseX >= shape.x && mouseX <= shape.x + shape.width &&
                    mouseY >= shape.y && mouseY <= shape.y + shape.height
                ) {
                    isDragging = true;
                    selectedShape = shape;
                    dragStartX = mouseX;
                    dragStartY = mouseY;
                    dragOffsetX = mouseX - shape.x;
                    dragOffsetY = mouseY - shape.y;
                    return;
                }
            }

        });

        canvas.addEventListener('mousemove', (event) => {
            if (isDragging) {
                const mouseX = event.offsetX;
                const mouseY = event.offsetY;
                selectedShape.x = mouseX - dragOffsetX;
                selectedShape.y = mouseY - dragOffsetY;
                updateConnectors(selectedShape);
                updateConnectorCoordinates();
                redraw();
            }
        });

        canvas.addEventListener('mouseup', (event) => {
            const mouseX = event.offsetX;
            const mouseY = event.offsetY;

            if (isDrawingConnector) {
                // Verifica si se hizo clic en un input de un shape
                for (const shape of shapes) {
                    for (const input of shape.inputs) {
                        if (
                            mouseX >= shape.x + input.x - 6 && mouseX <= shape.x + input.x + 6 &&
                            mouseY >= shape.y + input.y - 6 && mouseY <= shape.y + input.y + 6
                        ) {
                            endShape = shape;
                            endInput = input;

                            // Crea un conector desde el output al input
                            createConnector(startShape, startOutput, endShape, endInput);

                            isDrawingConnector = false;
                            startShape = null;
                            startOutput = null;
                            endShape = null;
                            endInput = null;

                            redraw();
                            return;
                        }
                    }
                }
            }


            if (isDragging) {
                isDragging = false;
                // selectedShape = null;
            }
        });

        function evaluateShapes() {
            for (const shape of shapes) {
                if (shape.type === "AND" || shape.type === "OR" || shape.type === "NOT" || shape.type === "NAND" || shape.type === "NOR"  || shape.type === "NAND3" || shape.type === "NOR3" || shape.type === "XOR" || shape.type === "XNOR" || shape.type === "AND3" || shape.type === "AND4" || shape.type === "AND5" || shape.type === "OR3" || shape.type === "OR4" || shape.type === "OR5" || shape.type === "SR_Flip_Flop" || shape.type === "D_Flip_Flop" || shape.type === "T_Flip_Flop" || shape.type === "JK_Flip_Flop" || shape.type === "Pin14" || shape.type.substring(0, 2) === "IC") {
                    evaluateGate(shape);
                }
                if(shape.type === "OutPutL"){
                    evaluateOutput(shape);
                }
                if(shape.type=="Display"){
                    evaluateDisplay(shape);
                }
            }
        }

        canvas.addEventListener('dblclick', (event) => {
            const mouseX = event.offsetX;
            const mouseY = event.offsetY;

            // Verifica si se hizo doble clic en una forma InputL
            for (const shape of shapes) {
                if (
                    shape.type === "InputL" &&
                    mouseX >= shape.x && mouseX <= shape.x + shape.width &&
                    mouseY >= shape.y && mouseY <= shape.y + shape.height
                ) {
                    toggleInputColor(shape);
                    evaluateShapes();
                    redraw();
                    return;
                }

                if (
                    shape.type === "Clock" &&
                    mouseX >= shape.x && mouseX <= shape.x + shape.width &&
                    mouseY >= shape.y && mouseY <= shape.y + shape.height
                ) {
                    toggleClock(shape);
                    return;
                }

                // Verifica si se hizo doble clic en una forma AND, OR, NOT o OutPutL
                if (
                    (shape.type === "AND" || shape.type === "OR" || shape.type === "NOT" || shape.type === "OutPutL" || shape.type === "NAND" || shape.type === "NOR"  || shape.type === "NAND3" || shape.type === "NOR3" || shape.type === "XOR" || shape.type === "XNOR" || shape.type === "AND3"  || shape.type === "AND4"  || shape.type === "AND5" || shape.type === "OR3" || shape.type === "OutPutL") &&
                    mouseX >= shape.x && mouseX <= shape.x + shape.width &&
                    mouseY >= shape.y && mouseY <= shape.y + shape.height
                ) {
                    if (shape.type === "OutPutL") {
                        evaluateOutput(shape);
                    } else {
                        evaluateGate(shape);
                    }
                    redraw();
                    return;
                }

                if (
                    shape.type === 'Text' &&
                    mouseX >= shape.x && mouseX <= shape.x + shape.width &&
                    mouseY >= shape.y && mouseY <= shape.y + shape.height
                ) {
                    // Solicita al usuario que ingrese o modifique el contenido del cuadro de texto
                    const newText = prompt('Ingrese el nuevo contenido del cuadro de texto:', shape.label);
                    if (newText !== null) {
                        shape.label = newText;
                        redraw();
                    }
                    return;
                }
                 // console.log(connectors);

            }

             // Verifica si se hizo clic en un punto de la línea de un conector existente
            for (const connector of connectors) {
                const startPoint = { x: connector.startShape.x + connector.startOutput.x, y: connector.startShape.y + connector.startOutput.y };
                const endPoint = { x: connector.endShape.x + connector.endInput.x, y: connector.endShape.y + connector.endInput.y };

                // Calcula la distancia del punto de clic al segmento de línea
                const distance = pointToLineDistance({ x: mouseX, y: mouseY }, startPoint, endPoint);

                // Si la distancia es menor a un valor umbral (puedes ajustar este valor según tu necesidad), agrega una ramificación
                if (distance < 10) {
                    console.log(connector.startShape);
                    addBranch(connector, { x: mouseX, y: mouseY });
                    break; // Puedes detener el bucle si solo deseas agregar una ramificación al primer conector que cumple la condición
                }
            }

        });

        // Función para calcular la distancia entre un punto y un segmento de línea
        function pointToLineDistance(point, lineStart, lineEnd) {
            const lineLength = Math.sqrt((lineEnd.x - lineStart.x) ** 2 + (lineEnd.y - lineStart.y) ** 2);
            if (lineLength === 0) return Math.sqrt((point.x - lineStart.x) ** 2 + (point.y - lineStart.y) ** 2);

            const t = Math.max(0, Math.min(1, ((point.x - lineStart.x) * (lineEnd.x - lineStart.x) + (point.y - lineStart.y) * (lineEnd.y - lineStart.y)) / (lineLength ** 2)));
            const projection = { x: lineStart.x + t * (lineEnd.x - lineStart.x), y: lineStart.y + t * (lineEnd.y - lineStart.y) };
            return Math.sqrt((point.x - projection.x) ** 2 + (point.y - projection.y) ** 2);
        }

        function createConnector(startShape, startOutput, endShape, endInput) {
            // Crea un conector desde el output al input
            const connector = {
                startShape,
                endShape,
                startOutput,
                endInput,
                isSelected: false
            };
            connectors.push(connector);
            
            // Imprimir información en la consola
            console.log("Nueva conexión creada:");
            console.log("Forma de origen:", startShape.name, startShape.type);
            console.log("Output de origen:", startOutput.label);
            console.log("Forma de destino:", endShape.name, endShape.type);
            console.log("Input de destino:", endInput.label);
            
            // Verificar si es una conexión a InputL y actualizar el color y Output A
            if (endShape.type === "InputL") {
                toggleInputColor(endShape);
            }
        }

        function toggleInputColor(inputShape) {
            inputShape.color = inputShape.color === "red" ? "green" : "red";
            inputShape.outputs[0].label = `Output A: ${inputShape.color === "red" ? '0' : '1'}`;
            inputShape.outputs[0].value = inputShape.color === "red" ? '0' : '1'
        }

  function evaluateGate(gateShape) {
            // Obtener las conexiones entrantes al AND, OR o NOT
            const inputConnections = connectors.filter(connector => connector.endShape === gateShape);
           
            // Crear un arreglo para almacenar los valores de entrada
            const inputValues = inputConnections.map(connection => {
                return connection.startShape.outputs[0].value === "1";
            });

            // Evaluar la operación lógica AND, OR o NOT
            let outputValues = [];
            if (gateShape.type === "AND" || gateShape.type === "AND3" || gateShape.type === "AND4" || gateShape.type === "AND5") {
                outputValues.push(inputValues.every(value => value === true));
            } else if (gateShape.type === "OR" || gateShape.type === "OR3" || gateShape.type === "OR4" || gateShape.type === "OR5") {
                outputValues.push(inputValues.some(value => value === true));
            } else if (gateShape.type === "NOT") {
                outputValues.push(!inputValues[0]);
            } else if (gateShape.type === "NAND" || gateShape.type === "NAND3") {
                outputValues.push(!(inputValues.every(value => value === true)));
            } else if (gateShape.type === "NOR" || gateShape.type === "NOR3") {
                outputValues.push(!(inputValues.some(value => value === true)));
            } else if (gateShape.type === "XOR" || gateShape.type === "XNOR") {
                // XOR y XNOR pueden tener múltiples salidas
                outputValues = inputValues.map(value => {
                    return gateShape.type === "XOR" ? (value ? 0 : 1) : (value ? 1 : 0);
                });
            } else if (gateShape.type === "SR_Flip_Flop" || gateShape.type === "D_Flip_Flop" || gateShape.type === "T_Flip_Flop" || gateShape.type === "JK_Flip_Flop" ) {
                // Flip Flops pueden tener múltiples salidas
                outputValues = [];

                // Obtener el valor de la entrada de reloj
                const clockInput = inputValues[2];
                const FFOutputlabel = gateShape.outputs[0].label;
                const FFOutputvalue = gateShape.outputs[0].value;
                
                // Resto de las entradas dependiendo del tipo de Flip-Flop
                let presetInput, clearInput, dataInput, toggleInput;

                if (gateShape.type === "SR_Flip_Flop") {
                    presetInput = inputValues[0];
                    clearInput = inputValues[1];
                    // outputValues = calculateSRNANDFlipFlop(clockInput, presetInput, clearInput);
                    outputValues = calculateSRFlipFlop(clockInput, presetInput, clearInput, FFOutputvalue);
                } else if (gateShape.type === "D_Flip_Flop") {
                    dataInput = inputValues[0];
                    outputValues = calculateDFlipFlop(clockInput, dataInput, FFOutputvalue);
                } else if (gateShape.type === "T_Flip_Flop") {
                    toggleInput = inputValues[0];
                    outputValues = calculateTFlopFlop(clockInput, toggleInput, FFOutputvalue);
                } else if (gateShape.type === "JK_Flip_Flop") {
                    const JInput = inputValues[0];
                    const KInput = inputValues[1];
                    outputValues = calculateJKFlipFlop(clockInput, JInput, KInput, FFOutputvalue);
                }
        } else if (gateShape.type === "IC7408") {
                // Flip Flops pueden tener múltiples salidas
                outputValues = [];
                outputValues[0] = andGate(inputValues[0],inputValues[1]);
                outputValues[1] = andGate(inputValues[2],inputValues[3]);
                // Output 2 Gnd
                outputValues[3] = andGate(inputValues[4],inputValues[5]);
                outputValues[4] = andGate(inputValues[6],inputValues[7]);
                // Input 5 Vcc
                for (let i = 0; i < gateShape.outputs.length; i++) {
                    gateShape.outputs[i].label = `OutPut: ${ outputValues[i] ? '1' : '0'}`;
                    gateShape.outputs[i].value = outputValues[i] ? '1' : '0';
                }
        } else if (gateShape.type === "IC7400") {
                // Flip Flops pueden tener múltiples salidas
                outputValues = [];
                outputValues[0] = nandGate(inputValues[0],inputValues[1]);
                outputValues[1] = nandGate(inputValues[2],inputValues[3]);
                // Output 2 Gnd
                outputValues[3] = nandGate(inputValues[4],inputValues[5]);
                outputValues[4] = nandGate(inputValues[6],inputValues[7]);
                // Input 5 Vcc 
                for (let i = 0; i < gateShape.outputs.length; i++) {
                    gateShape.outputs[i].label = `OutPut: ${ outputValues[i] ? '1' : '0'}`;
                    gateShape.outputs[i].value = outputValues[i] ? '1' : '0';
                }         
        } else if (gateShape.type === "IC7432") {
                // Flip Flops pueden tener múltiples salidas
                outputValues = [];
                outputValues[0] = orGate(inputValues[0],inputValues[1]);
                outputValues[1] = orGate(inputValues[2],inputValues[3]);
                // Output 2 Gnd
                outputValues[3] = orGate(inputValues[4],inputValues[5]);
                outputValues[4] = orGate(inputValues[6],inputValues[7]);
                // Input 5 Vcc 
                for (let i = 0; i < gateShape.outputs.length; i++) {
                    gateShape.outputs[i].label = `OutPut: ${ outputValues[i] ? '1' : '0'}`;
                    gateShape.outputs[i].value = outputValues[i] ? '1' : '0';
                } 
        } else if (gateShape.type === "IC7402") {
                // Flip Flops pueden tener múltiples salidas
                outputValues = [];
                outputValues[0] = norGate(inputValues[0],inputValues[1]);
                outputValues[1] = norGate(inputValues[2],inputValues[3]);
                // Output 2 Gnd
                outputValues[3] = norGate(inputValues[4],inputValues[5]);
                outputValues[4] = norGate(inputValues[6],inputValues[7]);
                // Input 5 Vcc
                for (let i = 0; i < gateShape.outputs.length; i++) {
                    gateShape.outputs[i].label = `OutPut: ${ outputValues[i] ? '1' : '0'}`;
                    gateShape.outputs[i].value = outputValues[i] ? '1' : '0';
                }
        } else if (gateShape.type === "IC7486") {
                // Flip Flops pueden tener múltiples salidas
                outputValues = [];
                outputValues[0] = xorGate(inputValues[0],inputValues[1]);
                outputValues[1] = xorGate(inputValues[2],inputValues[3]);
                // Output 2 Gnd
                outputValues[3] = xorGate(inputValues[4],inputValues[5]);
                outputValues[4] = xorGate(inputValues[6],inputValues[7]);
                // Input 5 Vcc
                for (let i = 0; i < gateShape.outputs.length; i++) {
                    gateShape.outputs[i].label =  `OutPut: ${ outputValues[i] ? '1' : '0'}`;
                    gateShape.outputs[i].value = outputValues[i] ? '1' : '0';
                }
        } else if (gateShape.type === "IC7404") {
                // Flip Flops pueden tener múltiples salidas
                outputValues = [];
                outputValues[0] = notGate(inputValues[0]);
                outputValues[1] = notGate(inputValues[1]);
                outputValues[2] = notGate(inputValues[2]);
                // Output 2 Gnd
                outputValues[3] = notGate(inputValues[3]);
                outputValues[4] = notGate(inputValues[4]);
                outputValues[5] = notGate(inputValues[5]);
                // Input 5 Vcc
                for (let i = 0; i < gateShape.outputs.length; i++) {
                    gateShape.outputs[i].label = `OutPut: ${ outputValues[i] ? '1' : '0'}`;
                    gateShape.outputs[i].value = outputValues[i] ? '1' : '0';
                }       
        } else if (gateShape.type === "Pin14") {
                // Pin14 pueden tener múltiples salidas
                bcdInput = '';
               
                result = false;

                for (const connection of inputConnections) {
                    const inputValue = connection.startShape.outputs[0].value === "1";
                   
                    if(inputValue){
                        bcdInput = bcdInput + '1';
                    } else {
                        bcdInput = bcdInput + '0';
                    }
 
                    result = inputValue;
 
                }

                var segments = bcdToSegments(bcdInput);


                for (let i = 0; i < gateShape.outputs.length; i++) {

                    gateShape.outputs[i].label = `Output ${String.fromCharCode(65 + i)}: ${segments[i] ? '1' : '0'}`;
                    gateShape.outputs[i].value = segments[i] ? '1' : '0';
                }
                 // console.log(connectors);
               
            }

            if (gateShape.type != "Pin14" && gateShape.type.substring(0, 2) != "IC" ) {
                // Actualizar el color y las etiquetas de salida según los resultados
                gateShape.color = outputValues.every(value => value === true) ? "green" : "red";
                for (let i = 0; i < gateShape.outputs.length; i++) {
                    gateShape.outputs[i].label = `Output ${String.fromCharCode(65 + i)}: ${outputValues[i] ? '1' : '0'}`;
                    gateShape.outputs[i].value = outputValues[i] ? '1' : '0';
                }
            }
        }


        function evaluateOutput(outputShape) {
            // Obtener las conexiones entrantes al AND, OR o NOT
            const inputConnection = connectors.find(connector => connector.endShape.name === outputShape.name);
            
            if (inputConnection) {
                // console.log(inputConnection);
                // Obtener el valor del conector
                const inputValue = inputConnection.startShape.outputs[0].value === "1";
                
                // Cambiar el color de OutPutL según el valor del conector
                outputShape.color = inputValue ? "green" : "red";

            }
        }

        function evaluateDisplay(displayShape){
            // Obtener las conexiones entrantes al AND, OR o NOT
            const inputConnections = connectors.filter(connector => connector.endShape === displayShape);

            i=0;
            for (const connection of inputConnections) {
                if(connection.startShape.outputs[i]){
                    const inputValue = connection.startShape.outputs[i].value === "1";
                
                    segmentColor = inputValue ? "blue" : "gray";
                    ctx.fillStyle = segmentColor; // Establece el color segun el input
                    segmentValue = inputValue ? "1" : "0";
                }    
                i++;
                // console.log(connection.endInput.label+": "+segmentValue);
                polygon = connection.endInput.label.split('')[connection.endInput.label.length - 1];
                drawPolygon(displayShape,polygons[polygon.toLowerCase()],6);
            }

        }


        // Función de cálculo para un SR Flip-Flop
        function calculateSRFlipFlop(clock, preset, clear, Q) {
            let Qbar = !Q;

            if(preset && clear){
                if(Q==false){
                    Q = false;
                }   
            } else if (!preset) {
                Q = andGate(preset, clear);
            } else {
                Q = orGate(preset, clear); 
            }

            if(!preset && !clear){
                Q = true;
                Qbar = true;
            } else {
                Qbar = !Q;
            }

            // console.log('A',logicvalue(preset),'B', logicvalue(clear),'Q', logicvalue(Q),'Q`', logicvalue(Qbar),'CLK', logicvalue(clock),'value', binaryvalue(Q)) ;

            return [Q, Qbar];
        }



        // Función de cálculo para un D Flip-Flop
        function calculateDFlipFlop(clock, data, Q) {
            let Qbar = !Q;

            Q = clock;

            if(data){
                Q = orGate(data,Q);
            } else {
                Q = andGate(data,Q);
            }

            if(!data && !clock){
                Q = false;
                Qbar = false;
            } else {
                Qbar = !Q;
            }

            return [Q, Qbar];
        }

        // Función de cálculo para un T Flip-Flop
        function calculateTFlopFlop(clock, toggle, Q) {
            let Qbar = !Q;

            if (clock) {
                if (toggle) {
                    Q = !Q;
                    Qbar = !Qbar;
                }
            } else if (Q){ 
                Q = true;
            } else { 
                Q = !toggle;
            }


            Qbar = !Q;

            return [Q, Qbar];
        }

        // Función de cálculo para un JK Flip-Flop
        function calculateJKFlipFlop(clock, J, K) {
            let Q = false;
            let Qbar = false;

            if (clock) {
                if (J && K) {
                    // No cambia el estado
                } else if (J) {
                    Q = true;
                    Qbar = false;
                } else if (K) {
                    Q = false;
                    Qbar = true;
                } else {
                    Q = !Qbar;
                    Qbar = !Q;
                }
            }

            return [Q, Qbar];
        }


        function updateConnectors(updatedShape) {
            for (const connector of connectors) {
                if (connector.startShape === updatedShape || connector.endShape === updatedShape) {

                    for(i = 0; i < connector.startShape.outputs.lenght; i++){
                        connector.startOutput.x = connector.startShape.outputs[i].x;
                        connector.startOutput.y = connector.startShape.outputs[i].y;
                    }
                    for(i = 0; i < connector.endShape.inputs.lenght; i++){
                        connector.endInput.x = connector.endShape.inputs[i].x;
                        connector.endInput.y = connector.endShape.inputs[i].y;
                    }
                }
            }
        }

        function redraw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawPattern();

            //booleanMath = 'F = ';
            for (const shape of shapes) {
                drawShape(shape);
                // booleanMath = booleanMath + getBooleanExpressionForShape(shape);
            }
            
            for (const connector of connectors) {
                drawConnector(connector);
            }

            //console.log(booleanMath);
            evaluateShapes();


        }

        // Define las coordenadas de los vértices para cada polígono
        var polygons = {
            a: [[1, 1], [2, 0], [8, 0], [9, 1], [8, 2], [2, 2]],
            b: [[9, 1], [10, 2], [10, 8], [9, 9], [8, 8], [8, 2]],
            c: [[9, 9], [10, 10], [10, 16], [9, 17], [8, 16], [8, 10]],
            d: [[9, 17], [8, 18], [2, 18], [1, 17], [2, 16], [8, 16]],
            e: [[1, 17], [0, 16], [0, 10], [1, 9], [2, 10], [2, 16]],
            f: [[1, 9], [0, 8], [0, 2], [1, 1], [2, 2], [2, 8]],
            g: [[1, 9], [2, 8], [8, 8], [9, 9], [8, 10], [2, 10]]
        };

        // Función para dibujar un polígono en el canvas
        function drawPolygon(shape,vertices, size) {
            // console.log(vertices);
            ctx.beginPath();
            ctx.moveTo(shape.x+vertices[0][0]*size, shape.y+vertices[0][1]*size);
            for (var i = 1; i < vertices.length; i++) {
                ctx.lineTo(shape.x+vertices[i][0]*size, shape.y+vertices[i][1]*size);
            }
            ctx.closePath();
            ctx.fill();
        }



        function drawConnector(connector) {
           
            const startX = connector.startShape.x + connector.startOutput.x;
            const startY = connector.startShape.y + connector.startOutput.y;
            const endX = connector.endShape.x + connector.endInput.x;
            const endY = connector.endShape.y + connector.endInput.y;

            // Puntos de control para curvas
            const controlPointX1 = startX + 30;
            const controlPointY1 = startY;
            const controlPointX2 = endX - 30;
            const controlPointY2 = endY;

            // Dibuja la línea de relación
            ctx.beginPath();
            ctx.moveTo(startX, startY);
            if (connector.isSelected) {
                ctx.strokeStyle = 'blue'; // Cambia el color a azul si está seleccionado
            } else {
                ctx.strokeStyle = 'black'; // Restablece el color normal
            }
            ctx.lineTo(controlPointX1, controlPointY1);
            ctx.quadraticCurveTo(startX, startY, controlPointX1, controlPointY1);
            ctx.lineTo(controlPointX2, controlPointY2);
            ctx.quadraticCurveTo(endX, endY, controlPointX2, controlPointY2);
            ctx.lineTo(endX, endY);
            ctx.stroke();

            /*
            ctx.beginPath();
            ctx.moveTo(connector.startShape.x + connector.startOutput.x, connector.startShape.y + connector.startOutput.y);
            ctx.lineTo(connector.endShape.x + connector.endInput.x, connector.endShape.y + connector.endInput.y);
            ctx.stroke();
            */
        }

        function addBranch(connector, startPoint) {
            // Dibuja una línea desde el punto de origen al input del endShape
            ctx.beginPath();
            ctx.moveTo(startPoint.x, startPoint.y);
            ctx.stroke();

            // Dibuja un pequeño círculo en el punto de origen
            drawCircle(startPoint);

            isDrawingConnector = true;
            startShape = connector.startShape;
            startOutput = connector.startOutput;

        }


        function drawShape(shape) {                        
            ctx.beginPath();
            // ctx.rect(shape.x, shape.y, shape.width, shape.height);
            // ctx.stroke();
       
        if(shape.type=="Text"){
            moveLabel = 0;
        } else if(shape.type=="Component"){
            moveLabel = 0;    
        } else if(shape.type=="Display"){
            moveLabel =  75;
            // Dibuja cada uno de los polígonos
            for (var key in polygons) {
                if (polygons.hasOwnProperty(key)) {
                    //  console.log(key);
                    ctx.fillStyle = "gray";
                    drawPolygon(shape,polygons[key],6);
                }
            } 
        } else if(shape.type=="Pin14" || shape.type.substring(0, 2) === "IC"){
            moveLabel =  150;
            drawIC(shape.x+15, shape.y, 60, 180, 7);
        } else {
            if(shape.type=="SR_Flip_Flop" || shape.type === "D_Flip_Flop" || shape.type=="T_Flip_Flop" || shape.type=="JK_Flip_Flop"){
                moveLabel = 55; 
            } else {
                moveLabel = 10;
            }    
            var svgURL = new XMLSerializer().serializeToString(document.getElementById(shape.type));
            var img = new Image();
            img.onload = function () {
                ctx.drawImage(this, shape.x, shape.y);
            };
            img.src = 'data:image/svg+xml; charset=utf8, ' + encodeURIComponent(svgURL);
        }

            // Cambiar el color de la forma InputL, AND, OR, NOT o OutPutL
            if (shape.type === "InputL" || shape.type === "AND" || shape.type === "OR" || shape.type === "NOT" || shape.type === "NAND" || shape.type === "NOR" || shape.type === "NAND3" || shape.type === "NOR3" || shape.type === "XOR" || shape.type === "XNOR" || shape.type === "AND3" || shape.type === "AND4" || shape.type === "AND5" || shape.type === "OR3" || shape.type === "OR4" || shape.type === "OR5" || shape.type === "Pin14" || shape.type.substring(0, 2)=== "IC" ) {
                ctx.fillStyle = shape.color;
                 //ctx.fillRect(shape.x, shape.y, shape.width, shape.height);
            }

            if(shape.type!="Text"){
                // Dibuja los puntos de entrada (inputs) y salida (outputs)
                for (const output of shape.outputs) {
                    drawCircle({ x: shape.x + output.x, y: shape.y + output.y });
                    drawText({ x: shape.x + output.x, y: shape.y + output.y }, output.label);
                }

                for (const input of shape.inputs) {
                    drawCircle({ x: shape.x + input.x, y: shape.y + input.y});
                    drawText({ x: shape.x + input.x, y: shape.y + input.y }, input.label);
                }
                if (shape.type === "OutPutL"){
                    ctx.fillStyle = shape.color;
                    ctx.beginPath();
                    ctx.arc(shape.x+24, shape.y+21, 18, 0, Math.PI * 2);
                    ctx.fill();
                }
            }

            // Dibuja el nombre del tipo de forma en el centro
            ctx.font = '14px Arial';
            ctx.fillStyle = shape.color;
            ctx.textAlign = 'center';
            ctx.fillText(shape.label, shape.x + shape.width / 2, shape.y + shape.height + moveLabel);
        }

        function drawCircle(point) {
            ctx.beginPath();
            ctx.arc(point.x, point.y, 6, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawText(point, text) {
            ctx.font = '12px Arial';
            ctx.fillStyle = 'black';
            ctx.fillText(text, point.x + 10, point.y - 10);
        }

        // Función para iniciar el arrastre de una
        function drag(event) {
            event.dataTransfer.setData("text", event.target.getAttribute("data-shape-type"));
        }

        // Función para permitir soltar formas en el lienzo
        canvas.addEventListener('dragover', (event) => {
            event.preventDefault();
        });

        // Función para manejar la soltura de formas en el lienzo
        canvas.addEventListener('drop', (event) => {
            event.preventDefault();
            const shapeType = event.dataTransfer.getData("text");

            const mouseX = event.offsetX;
            const mouseY = event.offsetY;

            createShape(mouseX, mouseY, shapeType);
 
        });

function createShape(mouseX, mouseY, shapeType){

// Crear una nueva forma en la posición donde se soltó
const newShape = {
    type: shapeType,
    x: mouseX,
    y: mouseY,
    width: 100,
    height: 50,
    label: shapeType,
    inputs: [],
    outputs: [],
    name: randomName(),
    isRunning: false, // Indicador para controlar si el reloj está en funcionamiento
    intervalId: null, // Identificador del intervalo para el pulso
    color: 'white' // Inicialmente blanco
};

// Define los puntos de entrada y salida para las formas creadas desde la barra lateral
if (shapeType === "InputL") {
    newShape.outputs.push({ x: 50, y: 25, label: `Output A: 0`, value: 0, name: randomName() });
    newShape.color = "red"; // Inicialmente rojo
} else if (shapeType === "OutPutL") {
    newShape.inputs.push({ x: 0, y: 25, label: 'Input A', value: 0, name: randomName() });

    // Evaluar el valor del OutputL al crearlo
    evaluateOutput(newShape);
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "Text") {
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "Clock") {
    newShape.outputs.push({ x: 50, y: 25, label: `Output A`, value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "AND") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input B', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "OR") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input B', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "OR3") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 25, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input C', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "OR4") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 25, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input C', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 55, label: 'Input D', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "OR5") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 25, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input C', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 55, label: 'Input D', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 70, label: 'Input E', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "NOT") {
    newShape.inputs.push({ x: 0, y: 25, label: 'Input A', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output B', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "NAND") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input B', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "NOR") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input B', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "NAND3") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 70, label: 'Input C', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "NOR3") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 70, label: 'Input C', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "XOR") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input B', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "XNOR") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input B', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "AND3") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 25, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input C', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "AND4") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 25, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input C', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 55, label: 'Input D', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "AND5") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 25, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input C', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 55, label: 'Input D', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 70, label: 'Input E', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 25, label: 'Output A', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "Display") {
    newShape.inputs.push({ x: 0, y: 10, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 25, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 40, label: 'Input C', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 55, label: 'Input D', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 70, label: 'Input E', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 85, label: 'Input F', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 100, label: 'Input G', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType === "SR_Flip_Flop") {
    newShape.inputs.push({ x: 0, y: 30, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 70, label: 'Input B', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 30, label: 'Output A', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 70, label: 'Output B', value: 0, name: randomName() });
} else if (shapeType === "D_Flip_Flop") {
    newShape.inputs.push({ x: 0, y: 30, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 70, label: 'Input B', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 30, label: 'Output A', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 70, label: 'Output B', value: 0, name: randomName() });
} else if (shapeType === "T_Flip_Flop") {
    newShape.inputs.push({ x: 0, y: 30, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 70, label: 'Input B', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 30, label: 'Output A', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 70, label: 'Output B', value: 0, name: randomName() });
} else if (shapeType === "JK_Flip_Flop") {
    newShape.inputs.push({ x: 0, y: 30, label: 'Input A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 50, label: 'Input B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 0, y: 70, label: 'Input C', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 30, label: 'Output A', value: 0, name: randomName() });
    newShape.outputs.push({ x: 100, y: 70, label: 'Output B', value: 0, name: randomName() });
} else if (shapeType === "Pin14") {
    newShape.inputs.push({ x: 20, y: 25, label: 'A', value: 0, name: randomName() });
    newShape.inputs.push({ x: 20, y: 50, label: 'B', value: 0, name: randomName() });
    newShape.inputs.push({ x: 20, y: 75, label: 'C', value: 0, name: randomName() });
    newShape.inputs.push({ x: 20, y: 100, label: 'D', value: 0, name: randomName() });
    newShape.inputs.push({ x: 20, y: 125, label: 'BI', value: 0, name: randomName() });
    newShape.inputs.push({ x: 20, y: 150, label: 'RBO', value: 0, name: randomName() });
    newShape.inputs.push({ x: 20, y: 175, label: 'LT', value: 0, name: randomName() });
    newShape.outputs.push({ x: 125, y: 25, label: 'QA', value: 0, name: randomName() });
    newShape.outputs.push({ x: 125, y: 50, label: 'QB', value: 0, name: randomName() });
    newShape.outputs.push({ x: 125, y: 75, label: 'QC', value: 0, name: randomName() });
    newShape.outputs.push({ x: 125, y: 100, label: 'QD', value: 0, name: randomName() });
    newShape.outputs.push({ x: 125, y: 125, label: 'QE', value: 0, name: randomName() });
    newShape.outputs.push({ x: 125, y: 150, label: 'QF', value: 0, name: randomName() });
    newShape.outputs.push({ x: 125, y: 175, label: 'QG', value: 0, name: randomName() });
    newShape.color = "gray"; // Inicialmente gris
} else if (shapeType.substring(0,2) === "IC") {
    if(shapeType=="IC7404"){
        newShape.inputs.push({ x: 20, y: 25, label: '1A', value: 0, name: randomName() });
        newShape.outputs.push({ x: 20, y: 50, label: '1Y', value: 0, name: randomName() });
        newShape.inputs.push({ x: 20, y: 75, label: '2A', value: 0, name: randomName() });
        newShape.outputs.push({ x: 20, y: 100, label: '2Y', value: 0, name: randomName() });
        newShape.inputs.push({ x: 20, y: 125, label: '3A', value: 0, name: randomName() });
        newShape.outputs.push({ x: 20, y: 150, label: '3Y', value: 0, name: randomName() });
        newShape.outputs.push({ x: 20, y: 175, label: 'GND', value: 0, name: randomName() });
        newShape.inputs.push({ x: 125, y: 25, label: 'Vcc', value: 0, name: randomName() });
        newShape.outputs.push({ x: 125, y: 50, label: '6A', value: 0, name: randomName() });
        newShape.inputs.push({ x: 125, y: 75, label: '6Y', value: 0, name: randomName() });
        newShape.outputs.push({ x: 125, y: 100, label: '5A', value: 0, name: randomName() });
        newShape.inputs.push({ x: 125, y: 125, label: '5Y', value: 0, name: randomName() });
        newShape.outputs.push({ x: 125, y: 150, label: '4A', value: 0, name: randomName() });
        newShape.inputs.push({ x: 125, y: 175, label: '4Y', value: 0, name: randomName() });
    } else {
        newShape.inputs.push({ x: 20, y: 25, label: '1A', value: 0, name: randomName() });
        newShape.inputs.push({ x: 20, y: 50, label: '1B', value: 0, name: randomName() });
        newShape.outputs.push({ x: 20, y: 75, label: '1Y', value: 0, name: randomName() });
        newShape.inputs.push({ x: 20, y: 100, label: '2A', value: 0, name: randomName() });
        newShape.inputs.push({ x: 20, y: 125, label: '2B', value: 0, name: randomName() });
        newShape.outputs.push({ x: 20, y: 150, label: '2Y', value: 0, name: randomName() });
        newShape.outputs.push({ x: 20, y: 175, label: 'GND', value: 0, name: randomName() });
        newShape.inputs.push({ x: 125, y: 25, label: 'Vcc', value: 0, name: randomName() });
        newShape.inputs.push({ x: 125, y: 50, label: '4B', value: 0, name: randomName() });
        newShape.inputs.push({ x: 125, y: 75, label: '4A', value: 0, name: randomName() });
        newShape.outputs.push({ x: 125, y: 100, label: '4Y', value: 0, name: randomName() });
        newShape.inputs.push({ x: 125, y: 125, label: '3B', value: 0, name: randomName() });
        newShape.inputs.push({ x: 125, y: 150, label: '3A', value: 0, name: randomName() });
        newShape.outputs.push({ x: 125, y: 175, label: '3Y', value: 0, name: randomName() });
    }
    newShape.color = "gray"; // Inicialmente gris
}

shapes.push(newShape);

// Redibujar para mostrar la nueva forma
redraw();

}

        function drawIC(x, y, ICWidth, ICHeight, ICNumPins) {

            var centerX =  x + ICWidth;
            var centerY =  y + 6;

            // Radio del círculo (parte superior del "cono")
            var radio = 10;

            // Ángulo inicial y final para dibujar la mitad del círculo (180 grados)
            var anguloInicial = 0;
            var anguloFinal = Math.PI;

            // Color de las figuras (negro)
            ctx.strokeStyle = "black";

            // Dibujar el círculo cortado sin relleno
            ctx.beginPath();
            ctx.arc(centerX, centerY, radio, anguloInicial, anguloFinal);
            ctx.lineTo(centerX, centerY); // Conectar con el centro
            ctx.stroke(); // Dibujar el trazo
            ctx.closePath();

            // Dibujar el rectángulo a partir del ecuador del círculo sin relleno
            ctx.strokeRect(centerX - ICWidth / 2, centerY, ICWidth, ICHeight); // Dibujar el trazo del rectángulo

            // Ancho y altura de los pines
            var pinAncho = 8;
            var pinAltura = 8;

            // Espacio entre los pines
            var espacioEntrePines = 17;

            // Distancia desde el centro hasta el borde del rectángulo, ajustada un poco hacia arriba
            var distanciaDesdeCentro = (ICHeight / ICWidth) - espacioEntrePines; // Ajuste de 10 unidades

            // Dibujar pines a la izquierda
            for (var i = 0; i < ICNumPins; i++) {
                var xPinIzquierda = centerX - ICWidth / 2 - pinAncho;
                var yPin = centerY - distanciaDesdeCentro + i * (pinAltura + espacioEntrePines);
                ctx.strokeRect(xPinIzquierda, yPin, pinAncho, pinAltura);
            }

            // Dibujar pines a la derecha
            for (var i = 0; i < ICNumPins; i++) {
                var xPinDerecha = centerX + ICWidth / 2;
                var yPin = centerY - distanciaDesdeCentro + i * (pinAltura + espacioEntrePines);
                ctx.strokeRect(xPinDerecha, yPin, pinAncho, pinAltura);
            }
        }

        function randomName() {
            const allowedchars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
            let randomName = '';

            for (let i = 0; i < 5; i++) {
                const randomIndex = Math.floor(Math.random() * allowedchars.length);
                randomName += allowedchars.charAt(randomIndex);
            }

            return randomName;
        }

        // Función para iniciar o detener el reloj
        function toggleClock(clockShape) {
            if (clockShape.isRunning) {
                clearInterval(clockShape.intervalId); // Detiene el intervalo si el reloj estaba en funcionamiento
                clockShape.isRunning = false;
                clockShape.color = "red";
            } else {
               
                // Inicia el intervalo para generar un pulso cada segundo (ajusta el intervalo según tus necesidades)
                clockShape.intervalId = setInterval(() => {
                    // Cambia el estado del reloj
                    clockShape.color = clockShape.color === "red" ? "green" : "red";
                    // console.log(clockShape.color);
                    clockShape.outputs[0].label = `Output A: ${clockShape.color === "red" ? '0' : '1'}`;
                    // console.log(clockShape.outputs[0].label);
                    // Redibuja el lienzo para reflejar el cambio de color
                    evaluateShapes();
                    redraw();
                }, 1000); // 1000 milisegundos = 1 segundo
                clockShape.isRunning = true;
            }
            redraw();

        }

        // Agregar un evento de clic al botón de guardar
        const saveButton = document.getElementById('saveButton');
        saveButton.addEventListener('click', saveToFile);

        // Función para guardar el contenido en un archivo JSON
        function saveToFile() {
            // Obtener el nombre del archivo del campo de entrada de texto
            var fileName = document.getElementById('fileName').value;

            if (!fileName) {
                fileName = 'Logic_gates';
            }

            // Crear un objeto que contiene el nombre del archivo y los datos a guardar
            var saveData = {
                fileName: fileName,
                shapes: shapes,
                connectors: connectors
            };

            // Convertir el objeto en una cadena JSON
            var jsonData = JSON.stringify(saveData);

            // Crear un enlace invisible para descargar el archivo JSON
            var a = document.createElement('a');
            var file = new Blob([jsonData], { type: 'application/json' });
            a.href = URL.createObjectURL(file);
            a.download = fileName + '.json';
            a.style.display = 'none';
            document.body.appendChild(a);

            // Simular un clic en el enlace para iniciar la descarga
            a.click();

            // Limpiar el enlace y el campo de entrada de texto
            document.body.removeChild(a);
            document.getElementById('fileName').value = '';
        }


        // Agregar un evento de clic al botón de cargar
        const loadButton = document.getElementById('loadButton');
        loadButton.addEventListener('click', loadFromFile);

        function loadFromFile() {
    // Obtener el control de entrada de archivo
    const input = document.getElementById('loadFile');

    // Agregar un evento de cambio para manejar la carga del archivo
    input.addEventListener('change', function (event) {
        const file = event.target.files[0];

        if (file) {
            const reader = new FileReader();

            reader.onload = function (e) {
                const contents = e.target.result;

                try {
                    // Parsear el contenido JSON
                    const data = JSON.parse(contents);

                    // Restaurar las formas y los conectores
                    shapes = data.shapes;
                    connectors = data.connectors;

                    // Ajustar las coordenadas de inicio y fin de las conexiones
                    updateConnectorCoordinates();

                    // Llamar a la función para dibujar
                    redraw();
                } catch (error) {
                    console.error('Error al cargar el archivo:', error);
                }
            };

            reader.readAsText(file);
        }
    });

    // Simular un clic en el control de entrada de archivo
    input.click();
}


function loadFromURL(url) {
    // Utiliza la función fetch para cargar el archivo JSON
    fetch(url)
    .then(response => {
        if (!response.ok) {
        throw new Error(`No se pudo cargar el archivo JSON. Status: ${response.status}`);
        }
        return response.json(); // Convierte la respuesta a JSON
    })
    .then(data => {
        // El objeto 'data' ahora contiene el contenido del archivo JSON
        // Puedes acceder a las formas (shapes) y conectores (connectors) aquí
        const loadedShapes = data.shapes;
        const loadedConnectors = data.connectors;

        // Haz lo que necesites con los datos cargados
        // Por ejemplo, puedes actualizar tu lista de 'shapes' y 'connectors' con estos datos
        shapes = loadedShapes;
        connectors = loadedConnectors;

        // Ajustar las coordenadas de inicio y fin de las conexiones
        updateConnectorCoordinates();

        // Llamar a la función para dibujar
        redraw();
    })
    .catch(error => {
        console.error('Error al cargar el archivo JSON:', error);
    });
}


        // Función para actualizar las coordenadas de inicio y fin de las conexiones
        function updateConnectorCoordinates() {
            var booleanExp = '';
            for (const connector of connectors) {
                const startShape = shapes.find(shape => shape.name === connector.startShape.name);
                const endShape = shapes.find(shape => shape.name === connector.endShape.name);
                booleanExp = booleanExp + getBooleanExpression(connector);
                if (startShape && endShape) {
                    connector.startShape = startShape;
                    connector.endShape = endShape;
                    connector.startOutput = startShape.outputs.find(output => output.label === connector.startOutput.label);
                    connector.endInput = endShape.inputs.find(input => input.label === connector.endInput.label);
                }
            }
            // console.log(booleanExp);
        }

    function getBooleanExpression(connector) {
        const startShapeType = connector.startShape.type;
        const endShapeType = connector.endShape.type;
        const startOutputLabel = connector.startOutput.label;
        const endInputLabel = connector.endInput.label;

        // Define las variables booleanas correspondientes a las salidas de las formas de inicio y fin
        const startOutputVariable = `${startShapeType}_${startOutputLabel}`;
        const endInputVariable = `${endShapeType}_${endInputLabel}`;

        // Genera la expresión booleana en función de la lógica de las formas conectadas
        let booleanExpression = '';

        if (startShapeType === 'InputL') {
            // Si la forma de inicio es un InputL, la variable booleana de inicio es directamente su color
              booleanExpression = `${startOutputVariable}`;
        } else {
            // Si la forma de inicio es una compuerta lógica, usa la lógica correspondiente
            switch (startShapeType) {
                case 'AND':
                    booleanExpression = `(${startOutputVariable} AND ${endInputVariable})`;
                    break;
                case 'OR':
                    booleanExpression = `(${startOutputVariable} OR ${endInputVariable})`;
                    break;
                case 'NOT':
                    booleanExpression = `(NOT ${startOutputVariable})`;
                    break;
                // Agrega casos para otras compuertas lógicas si es necesario
            }
        }

        return booleanExpression;
    }

    function getBooleanExpressionForShape(shape) {
    const shapeType = shape.type;

    // Verifica el tipo de forma y genera la expresión booleana correspondiente
    switch (shapeType) {
        case 'AND':
            return generateANDBooleanExpression(shape);
        case 'OR':
            return generateORBooleanExpression(shape);
        case 'NOT':
            return generateNOTBooleanExpression(shape);
        case 'NAND':
            return generateNANDBooleanExpression(shape);
        case 'NOR':
            return generateNORBooleanExpression(shape);
        case 'XOR':
            return generateXORBooleanExpression(shape);
        case 'XNOR':
            return generateXNORBooleanExpression(shape);
        // Agrega casos para otros tipos de formas si es necesario
        default:
            return '';
    }
}

// Funciones para generar expresiones booleanas para diferentes tipos de formas lógicas

function generateANDBooleanExpression(shape) {
    const inputs = shape.inputs.map(input => input.label.split('')[input.label.length - 1]  ).join('*');
    const output = shape.outputs[0].label;
    return `(${inputs})`;
}

function generateORBooleanExpression(shape) {
    const inputs = shape.inputs.map(input => input.label.split('')[input.label.length - 1]  ).join('+');
    const output = shape.outputs[0].label;
    return `(${inputs})`;
}

function generateNOTBooleanExpression(shape) {
    const input = shape.inputs[0].label.split('')[shape.inputs[0].label.length - 1];
    const output = shape.outputs[0].label;
    return `(${input}')`;
}

function generateNANDBooleanExpression(shape) {
    const inputs = shape.inputs.map(input => input.label.split('')[input.label.length - 1]  ).join('*');
    const output = shape.outputs[0].label;
    return `(${inputs})'`;
}

function generateNORBooleanExpression(shape) {
    const inputs = shape.inputs.map(input => input.label.split('')[input.label.length - 1]  ).join('+');
    const output = shape.outputs[0].label;
    return `(${inputs})'`;
}

function generateXORBooleanExpression(shape) {
    const inputs = shape.inputs.map(input => input.label.split('')[input.label.length - 1]  ).join('*');
    const inputs2 = shape.inputs.map(input => input.label.split('')[input.label.length - 1]  ).join("'*");
    const output = shape.outputs[0].label;
    return `(${inputs}'+${inputs2})`;
}

function generateXNORBooleanExpression(shape) {
    const inputs = shape.inputs.map(input => input.label.split('')[input.label.length - 1]  ).join('*');
    const inputs2 = shape.inputs.map(input => input.label.split('')[input.label.length - 1]  ).join("'*");
    const output = shape.outputs[0].label;
    return `(${inputs}'+${inputs2})'`;
}

function deleteSelectedShape() {
    if (confirm('Delete '+selectedShape.type+' Component') == true) {
        if (selectedShape) {
            // Encuentra la shape seleccionada en el arreglo de shapes y elimínala
            const index = shapes.indexOf(selectedShape);
            if (index !== -1) {
                shapes.splice(index, 1);
                selectedShape = null; // Deselecciona la shape
                redraw();
            }
        }
    }
   
}    

function deleteSelectedConnector() {
    if (confirm('Delete '+selectedConnector.startShape.type+' to '+selectedConnector.endShape.type+' Connector') == true) {
        if (selectedConnector) {
            // Encuentra la conexión seleccionada en el arreglo de conexiones y elimínala
            const index = connectors.indexOf(selectedConnector);
            if (index !== -1) {
                connectors.splice(index, 1);
                selectedConnector = null; // Deselecciona la conexión
                redraw();
            }
        }
    }
}

document.addEventListener('keydown', (event) => {

    if (event.key === 'Delete' && selectedConnector) {
        // Si se presiona la tecla "Delete" y hay una conexión seleccionada, elimínala
        deleteSelectedConnector();
    }
    if (event.key === 'Delete' && selectedShape) {
        deleteSelectedShape();
    }
});

canvas.addEventListener('click', (event) => {
    const mouseX = event.offsetX;
    const mouseY = event.offsetY;

    // Verifica si se hizo clic en una conexión
    for (const connector of connectors) {
        const startX = connector.startShape.x + connector.startOutput.x;
        const startY = connector.startShape.y + connector.startOutput.y;
        const endX = connector.endShape.x + connector.endInput.x;
        const endY = connector.endShape.y + connector.endInput.y;

       

        // Calcula si el clic está cerca de la conexión
        const distance = Math.sqrt((mouseX - startX) ** 2 + (mouseY - startY) ** 2);
        if (distance < 60) {
            // Cambia el estado isSelected del conector
            connector.isSelected = !connector.isSelected;
            selectedConnector = connector;
            connector.isSelected = true;
            // Redibuja el lienzo para reflejar el cambio de estado
            redraw();
            return;
        }

        const distance2 = Math.sqrt((mouseX - endX) ** 2 + (mouseY - endY) ** 2);
        if (distance2 < 6) {
            // Cambia el estado isSelected del conector
            connector.isSelected = !connector.isSelected;
            selectedConnector = connector;
            connector.isSelected = true;
            // Redibuja el lienzo para reflejar el cambio de estado
            redraw();
            return;
        }
    }

    // Si no se hizo clic en ninguna conexión, deselecciona todas las conexiones
    selectedConnector = null;
    for (const connector of connectors) {
        connector.isSelected = false;
        drawConnector(connector);
    }

    // Verificar si se hizo clic en una forma
    for (const shape of shapes) {
        if (
            mouseX >= shape.x && mouseX <= shape.x + shape.width &&
            mouseY >= shape.y && mouseY <= shape.y + shape.height
        ) {
            // Mostrar las propiedades de la forma
            showShapeProperties(shape);
            return;
        }
    }


});


// Tabla de verdad BCD a 7 segmentos
function bcdToSegments(bcd) {
    switch (bcd) {
        case "0000":
            return [1, 1, 1, 1, 1, 1, 0]; // 0
        case "0001":
            return [0, 1, 1, 0, 0, 0, 0]; // 1
        case "0010":
            return [1, 1, 0, 1, 1, 0, 1]; // 2
        case "0011":
            return [1, 1, 1, 1, 0, 0, 1]; // 3
        case "0100":
            return [0, 1, 1, 0, 0, 1, 1]; // 4
        case "0101":
            return [1, 0, 1, 1, 0, 1, 1]; // 5
        case "0110":
            return [1, 0, 1, 1, 1, 1, 1]; // 6
        case "0111":
            return [1, 1, 1, 0, 0, 0, 0]; // 7
        case "1000":
            return [1, 1, 1, 1, 1, 1, 1]; // 8
        case "1001":
            return [1, 1, 1, 1, 0, 1, 1]; // 9
        default:
            return [0, 0, 0, 0, 0, 0, 0]; // Invalid
    }
}



// Función para mostrar la salida en los segmentos
function showOutput(bcd,bcdInput) {
    console.log(bcd);
    var segments = bcdToSegments(bcdInput);

    bcd.outputs.forEach(function (index) {
        console.log(bcd.outputs[segments[index]].label);
        if (segments[index]) {
           bcd.outputs[segments[index]].label = `Q : ${clockShape.color === "blue" ? '0' : '1'}`;
           bcd.outputs[segments[index]].value = `${clockShape.color === "blue" ? '0' : '1'}`;
        }
    });
}

function createNewCircuit() {
    // Elimina todas las formas y conectores existentes
    shapes = [];
    connectors = [];

    // Redibujar para limpiar el lienzo
    redraw();
}

function generateTruthTable() {
    // Verificar si hay al menos una entrada y una salida
    const inputShapes = shapes.filter(shape => shape.type === "InputL");
    const outputShapes = shapes.filter(shape => shape.type === "OutPutL");
    
    if (inputShapes.length === 0 || outputShapes.length === 0) {
        alert("Debe haber al menos una entrada y una salida en el circuito para generar la tabla de verdad.");
        return;
    }

    // Crear un objeto que representará la tabla de verdad
    const truthTable = [];

    // Obtener las etiquetas de las entradas
    const inputLabels = inputShapes.map(shape => shape.label);

    // Obtener las etiquetas de las salidas
    const outputLabels = outputShapes.map(shape => shape.label);

    // Calcular la cantidad total de combinaciones posibles
    const totalCombinations = 2 ** inputLabels.length;

    // Generar todas las combinaciones posibles de entradas y evaluar el circuito
    for (let i = 0; i < totalCombinations; i++) {
        const binaryInputs = getBinaryString(i, inputLabels.length);
        const inputValues = binaryInputs.split('').map(Number);

        // Configurar los valores de las entradas
        inputShapes.forEach((shape, index) => {
            shape.color = inputValues[index] === 0 ? "red" : "green";
            shape.outputs[0].label = `Output A: ${inputValues[index]}`;
        });

        // Evaluar el circuito y obtener los valores de las salidas
        const outputValues = outputShapes.map(shape => {
            evaluateOutput(shape);
            return shape.color === "green" ? 1 : 0;
        });

        // Agregar esta combinación a la tabla de verdad
        truthTable.push([...inputValues, ...outputValues]);
    }

    // Imprimir la tabla de verdad en la consola
    console.log("Tabla de Verdad:");
    console.log("Entradas:", inputLabels.join(", "));
    console.log("Salidas:", outputLabels.join(", "));
    console.table(truthTable);

    return truthTable;
}

function getBinaryString(number, length) {
    // Convierte un número decimal a una cadena binaria con relleno de ceros
    let binaryString = number.toString(2);
    while (binaryString.length < length) {
        binaryString = "0" + binaryString;
    }
    return binaryString;
}

function createShapesFromTruthTable(gateType) {
    //  const shapes = [];
    truthTable = generateTruthTable();
    // console.log(truthTable);

    // Asume que gateType es uno de los tipos de puertas lógicas que defines (AND, OR, etc.)
    // Asegúrate de tener las definiciones adecuadas de las shapes en tu código.

    for (const row of truthTable) {
        const newShape = {
            type: gateType,
            x: 0, // Establece las coordenadas iniciales
            y: 0,
            width: 100, // Establece el tamaño predeterminado
            height: 50,
            label: gateType,
            inputs: [],
            outputs: [],
            name: randomName(),
            isRunning: false, // Indicador para controlar si el reloj está en funcionamiento
            intervalId: null, // Identificador del intervalo para el pulso
        };

        // Agrega entradas según la tabla de verdad
        for (const key in row) {
            if (key.startsWith('input')) {
                newShape.inputs.push({ x: 0, y: 0, label: `${key}: ${row[key]}` });
            }
        }

        // Agrega una salida según la tabla de verdad
        newShape.outputs.push({ x: 0, y: 0, label: `Output: ${row.output}` });

        shapes.push(newShape);
        console.log(newShape);
    }

    return shapes;
}

function buildComponent(){

    const newShapes = createShapesFromTruthTable("Component");

    // Agrega las nuevas shapes al arreglo de shapes existente
    shapes = shapes.concat(newShapes);

    // Redibuja el contenido del canvas
    redraw();
}

// Agregar un evento de contexto al lienzo para mostrar las propiedades al hacer clic derecho
canvas.addEventListener('contextmenu', (event) => {
    event.preventDefault();
    const mouseX = event.offsetX;
    const mouseY = event.offsetY;

    // Verificar si se hizo clic en una forma
    for (const shape of shapes) {
        if (
            mouseX >= shape.x && mouseX <= shape.x + shape.width &&
            mouseY >= shape.y && mouseY <= shape.y + shape.height
        ) {
            // Mostrar las propiedades de la forma
            showShapeProperties(shape);
            return;
        }
    }

    // Si se hizo clic fuera de una forma, ocultar las propiedades
    hideShapeProperties();
});

// Función para mostrar las propiedades de la forma y las etiquetas de inputs y outputs
function showShapeProperties(shape) {
    const propertiesDiv = document.getElementById('properties');
    const shapeLabelInput = document.getElementById('shapeLabel');
    const shapeXInput = document.getElementById('shapeX');
    const shapeYInput = document.getElementById('shapeY');
    const colorSelect = document.getElementById('colorSelect'); // Campo de selección de color
    const applyButton = document.getElementById('applyProperties');
    const inputsContainer = document.getElementById('inputsContainer'); // Contenedor para inputs
    const outputsContainer = document.getElementById('outputsContainer'); // Contenedor para outputs

    // Llenar los campos de entrada con las propiedades actuales de la forma
    shapeLabelInput.value = shape.label;
    shapeXInput.value = shape.x;
    shapeYInput.value = shape.y;
    colorSelect.value = shape.color; // Configurar el valor del campo de selección de color

    // Eliminar campos de entrada anteriores (si los hay)
    while (inputsContainer.firstChild) {
        inputsContainer.removeChild(inputsContainer.firstChild);
    }

    while (outputsContainer.firstChild) {
        outputsContainer.removeChild(outputsContainer.firstChild);
    }

    // Crear campos de entrada para las etiquetas de inputs
    for (let i = 0; i < shape.inputs.length; i++) {
        const inputLabelInput = document.createElement('input');
        inputLabelInput.type = 'text';
        inputLabelInput.value = shape.inputs[i].label;
        inputLabelInput.placeholder = `Etiqueta del Input ${i + 1}`;
        inputsContainer.appendChild(inputLabelInput);
    }

    // Crear campos de entrada para las etiquetas de outputs
    for (let i = 0; i < shape.outputs.length; i++) {
        const outputLabelInput = document.createElement('input');
        outputLabelInput.type = 'text';
        outputLabelInput.value = shape.outputs[i].label;
        outputLabelInput.placeholder = `Etiqueta del Output ${i + 1}`;
        outputsContainer.appendChild(outputLabelInput);
    }

    // Mostrar el div de propiedades
    propertiesDiv.style.display = 'block';

    // Agregar un evento al botón de aplicar para actualizar las propiedades
    applyButton.onclick = () => {
        shape.label = shapeLabelInput.value;
        shape.x = parseInt(shapeXInput.value);
        shape.y = parseInt(shapeYInput.value);
        shape.color = colorSelect.value; // Actualizar el color desde el campo de selección de color

        // Actualizar las etiquetas de inputs desde los campos de entrada
        for (let i = 0; i < shape.inputs.length; i++) {
            shape.inputs[i].label = inputsContainer.children[i].value;
        }

        // Actualizar las etiquetas de outputs desde los campos de entrada
        for (let i = 0; i < shape.outputs.length; i++) {
            shape.outputs[i].label = outputsContainer.children[i].value;
        }

        redraw();
        hideShapeProperties();
    };
}


// Función para ocultar las propiedades de la forma
function hideShapeProperties() {
    const propertiesDiv = document.getElementById('properties');
    propertiesDiv.style.display = 'none';
}

let copiedShape = null; // Variable global para almacenar la figura copiada

// Función para copiar la figura seleccionada
function copySelectedShape() {
    copiedShape = selectedShape ? { ...selectedShape } : null; // Clona la figura seleccionada
}

// Función para cortar la figura seleccionada
function cutSelectedShape() {
    if (selectedShape) {
        copiedShape = { ...selectedShape }; // Clona la figura seleccionada
        // Elimina la figura seleccionada del arreglo shapes
        const index = shapes.indexOf(selectedShape);
        if (index !== -1) {
            shapes.splice(index, 1);
        }
        selectedShape = null;
        redraw();
        hideShapeProperties();
    }
}

// Función para pegar la figura copiada
function pasteShape() {
    // Calcula una nueva posición para la figura copiada
    const newX = copiedShape.x + 20; // Ajusta la posición horizontal
    const newY = copiedShape.y + 20; // Ajusta la posición vertical
    copiedShape.x = newX;
    copiedShape.y = newY;
    selectedShape = copiedShape; // Selecciona la figura copiada
    createShape(newX, newY, copiedShape.type);
    // createShape redraw the grid
}


// Función para mover la figura seleccionada
function moveSelectedShape(direction) {
    if (selectedShape) {
        const step = 10; // Tamaño del paso para el movimiento
        switch (direction) {
            case 'up':
                selectedShape.y -= step;
                break;
            case 'down':
                selectedShape.y += step;
                break;
            case 'left':
                selectedShape.x -= step;
                break;
            case 'right':
                selectedShape.x += step;
                break;
        }
        redraw();
    }
}

    </script>
</body>
</html>
